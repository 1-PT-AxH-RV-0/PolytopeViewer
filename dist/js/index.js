/*! For license information please see index.js.LICENSE.txt */
(()=>{"use strict";var t,e={208:(t,e,r)=>{r.d(e,{A:()=>s});var n=r(601),i=r.n(n),o=r(314),a=r.n(o)()(i());a.push([t.id,"body {\n  margin: 8px;\n  font-family: monospace, system-ui;\n}\n\n.info {\n  position: absolute;\n  left: 12px;\n  top: 12px;\n  font-size: 0.5rem;\n  color: white;\n  pointer-events: none;\n}\n\n.prog {\n  position: absolute;\n  left: 50vw;\n  top: 50vw;\n  transform: translate(-50%, -50%);\n  text-align: center;\n  font-size: 2rem;\n  color: white;\n  pointer-events: none;\n}\n",""]);const s=a},692:(t,e,r)=>{var n=r(72),i=r.n(n),o=r(825),a=r.n(o),s=r(659),c=r.n(s),l=r(56),u=r.n(l),f=r(540),h=r.n(f),d=r(113),p=r.n(d),v=r(208),y={};y.styleTagTransform=p(),y.setAttributes=u(),y.insert=c().bind(null,"head"),y.domAPI=a(),y.insertStyleElement=h();i()(v.A,y);v.A&&v.A.locals&&v.A.locals;var m=r(922),w=r(437),g=r(34),b=r(264),x=r(385);const S="\nvec3 schlegelProjection(vec4 point4D) {\n  if (isOrtho) return point4D.xyz;\n  return projectionDistance * point4D.xyz / (projectionDistance - point4D.w);\n}\n",j="\nmat4 create4DRotationMat(float xy_deg, float xz_deg, float xw_deg, \n                         float yz_deg, float yw_deg, float zw_deg) {\n    // 将角度转换为弧度\n    float xy = radians(xy_deg);\n    float xz = radians(xz_deg);\n    float xw = radians(xw_deg);\n    float yz = radians(yz_deg);\n    float yw = radians(yw_deg);\n    float zw = radians(zw_deg);\n    \n    // 计算各旋转角度的正弦和余弦\n    float cxy = cos(xy), sxy = sin(xy);\n    float cxz = cos(xz), sxz = sin(xz);\n    float cxw = cos(xw), sxw = sin(xw);\n    float cyz = cos(yz), syz = sin(yz);\n    float cyw = cos(yw), syw = sin(yw);\n    float czw = cos(zw), szw = sin(zw);\n    \n    // 初始化六个基本旋转矩阵\n    mat4 Rxy = mat4(\n        cxy, -sxy, 0.0, 0.0,\n        sxy,  cxy, 0.0, 0.0,\n        0.0,  0.0, 1.0, 0.0,\n        0.0,  0.0, 0.0, 1.0\n    );\n    \n    mat4 Rxz = mat4(\n        cxz, 0.0, -sxz, 0.0,\n        0.0, 1.0,  0.0, 0.0,\n        sxz, 0.0,  cxz, 0.0,\n        0.0, 0.0,  0.0, 1.0\n    );\n    \n    mat4 Rxw = mat4(\n        cxw, 0.0, 0.0, -sxw,\n        0.0, 1.0, 0.0,  0.0,\n        0.0, 0.0, 1.0,  0.0,\n        sxw, 0.0, 0.0,  cxw\n    );\n    \n    mat4 Ryz = mat4(\n        1.0,  0.0, 0.0, 0.0,\n        0.0,  cyz, -syz, 0.0,\n        0.0,  syz,  cyz, 0.0,\n        0.0,  0.0, 0.0, 1.0\n    );\n    \n    mat4 Ryw = mat4(\n        1.0, 0.0,  0.0, 0.0,\n        0.0, cyw,  0.0, -syw,\n        0.0, 0.0,  1.0, 0.0,\n        0.0, syw,  0.0, cyw\n    );\n    \n    mat4 Rzw = mat4(\n        1.0, 0.0, 0.0,  0.0,\n        0.0, 1.0, 0.0,  0.0,\n        0.0, 0.0, czw, -szw,\n        0.0, 0.0, szw,  czw\n    );\n    \n    // 组合所有旋转（顺序会影响最终结果）\n    return Rzw * Ryw * Ryz * Rxw * Rxz * Rxy;\n}\n\nmat4 create4DRotationMat(float rotation4D[6]) {\n    return create4DRotationMat(rotation4D[0], rotation4D[1], rotation4D[2], \n                               rotation4D[3], rotation4D[4], rotation4D[5]);\n}\n",D="\nvec3 transformCylinderPoint(vec3 point, vec3 v1, vec3 v2) {\n    // Compute direction and length\n    vec3 d = v2 - v1;\n    float d_length = length(d);\n    \n    // If v1 and v2 are too close, return v1 (or discard)\n    if (d_length < 1e-6) {\n        return v1; // Or handle as error\n    }\n    vec3 d_normalized = d / d_length;\n\n    // Step 1: Scale along y-axis\n    vec3 scaled_point = point * vec3(1.0, d_length, 1.0);\n\n    // Step 2: Rotate y-axis to d_normalized\n    vec3 y_axis = vec3(0.0, 1.0, 0.0);\n    float dot_product = dot(y_axis, d_normalized);\n    \n    // Handle parallel cases (dot_product ≈ ±1)\n    if (abs(dot_product) > 0.99999) {\n        if (dot_product < 0.0) {\n            // Opposite direction: rotate 180° around x-axis\n            scaled_point.y = -scaled_point.y; // Equivalent to 180° rotation\n        }\n        // Else: same direction, no rotation needed\n    } else {\n        // General case: compute rotation axis and angle\n        vec3 rotation_axis = normalize(cross(d_normalized, y_axis));\n        float rotation_angle = acos(clamp(dot_product, -1.0, 1.0));\n        \n        // Rodrigues' rotation formula\n        float cos_angle = cos(rotation_angle);\n        float sin_angle = sin(rotation_angle);\n        \n        mat3 K = mat3(\n            0.0, -rotation_axis.z, rotation_axis.y,\n            rotation_axis.z, 0.0, -rotation_axis.x,\n            -rotation_axis.y, rotation_axis.x, 0.0\n        );\n        mat3 R = mat3(1.0) + sin_angle * K + (1.0 - cos_angle) * (K * K);\n        scaled_point = R * scaled_point;\n    }\n\n    // Step 3: Translate to v1\n    return scaled_point + v1;\n}\n";const _={sphereMaterial:function(t,e,r,n,i){return(t=t.clone()).onBeforeCompile=function(t){t.uniforms.projectionDistance=n,t.uniforms.rotation4D=r,t.uniforms.radius=e,t.uniforms.isOrtho=i,t.vertexShader="\n      attribute vec4 center4D;\n      uniform float radius;\n      uniform float projectionDistance;\n      uniform bool isOrtho;\n      uniform float rotation4D[6];\n\n      ".concat(S,"\n      ").concat(j,"\n      ").concat(t.vertexShader,"\n    "),t.vertexShader=t.vertexShader.replace("#include <begin_vertex>","\n      #include <begin_vertex>\n      // 将顶点按球体半径缩放，再加上中心点的 3D 投影\n      vec3 center3D = schlegelProjection(create4DRotationMat(rotation4D) * center4D);\n      transformed = transformed * radius + center3D;\n      ")},t},cylinderMaterial:function(t,e,r,n,i){return(t=t.clone()).onBeforeCompile=function(t){t.uniforms.projectionDistance=n,t.uniforms.rotation4D=r,t.uniforms.radius=e,t.uniforms.isOrtho=i,t.vertexShader="\n      attribute vec4 v1;\n      attribute vec4 v2;\n      uniform float radius;\n      uniform float projectionDistance;\n      uniform bool isOrtho;\n      uniform float rotation4D[6];\n      \n      ".concat(S,"\n      ").concat(j,"\n      ").concat(D,"\n      ").concat(t.vertexShader,"\n    "),t.vertexShader=t.vertexShader.replace("#include <begin_vertex>","\n      #include <begin_vertex>\n      // 计算 4D 空间中圆柱两端点的投影\n      mat4 rotMat = create4DRotationMat(rotation4D);\n      vec3 pv1 = schlegelProjection(rotMat * v1);\n      vec3 pv2 = schlegelProjection(rotMat * v2);\n      // 将模型顶点在 x, z 方向缩放至所需半径（让圆柱变粗/细）\n      transformed.x *= radius;\n      transformed.z *= radius;\n      // 将顶点旋转平移到合适位置\n      transformed = transformCylinderPoint(transformed + vec3(0.0, 0.5, 0.0), pv1, pv2);\n      ")},t},sphereMaterial3D:function(t,e){return(t=t.clone()).onBeforeCompile=function(t){t.uniforms.radius=e,t.vertexShader="\n      uniform float radius;\n      ".concat(t.vertexShader,"\n    "),t.vertexShader=t.vertexShader.replace("#include <begin_vertex>","\n      #include <begin_vertex>\n      // 顶点按 radius 统一缩放\n      transformed *= radius;\n      ")},t},cylinderMaterial3D:function(t,e){return(t=t.clone()).onBeforeCompile=function(t){t.uniforms.radius=e,t.vertexShader="\n      uniform float radius;\n      ".concat(t.vertexShader,"\n    "),t.vertexShader=t.vertexShader.replace("#include <begin_vertex>","\n      #include <begin_vertex>\n      // 让圆柱变粗/细\n      transformed.x *= radius;\n      transformed.z *= radius;\n      ")},t},faceMaterial:function(t,e,r,n){return(t=t.clone()).onBeforeCompile=function(t){t.uniforms.projectionDistance=r,t.uniforms.rotation4D=e,t.uniforms.isOrtho=n,t.vertexShader="\n      attribute vec4 position4D;\n      uniform float projectionDistance;\n      uniform bool isOrtho;\n      uniform float rotation4D[6];\n      \n      ".concat(S,"\n      ").concat(j,"\n      ").concat(t.vertexShader,"\n    "),t.vertexShader=t.vertexShader.replace("#include <begin_vertex>","\n      #include <begin_vertex>\n      // 将四维位置旋转后投影到三维空间\n      vec4 rotatedPosition4D = create4DRotationMat(rotation4D) * position4D;\n      transformed = schlegelProjection(rotatedPosition4D);\n      ")},t},axisMaterial:function(t,e){return(t=t.clone()).onBeforeCompile=function(t){t.uniforms.rotation4D=e,t.vertexShader="\n      attribute uint axis;\n      attribute float len;\n      uniform float rotation4D[6];\n      \n      ".concat(j,"\n      ").concat(D,"\n      ").concat(t.vertexShader,"\n    "),t.vertexShader=t.vertexShader.replace("#include <begin_vertex>","\n      #include <begin_vertex>\n      // 根据 axis 决定投影到四维哪条轴上\n      vec4 v = vec4(0.0);\n      if (axis == 0u) v.x = 1.0;\n      else if (axis == 1u) v.y = 1.0;\n      else if (axis == 2u) v.z = 1.0;\n      else if (axis == 3u) v.w = 1.0;\n      // 投影并计算缩放，使圆柱长度符合 len\n      vec3 vProj = (create4DRotationMat(rotation4D) * v).xyz;\n      float s = length(vProj) / length(v);\n      float scale = len / length(vProj) * s;\n      vProj *= scale;\n      // 旋转与平移\n      transformed = transformCylinderPoint(position + vec3(0.0, 0.5, 0.0), -vProj, vProj);\n      ")},t},axisConeMaterial:function(t,e){return(t=t.clone()).onBeforeCompile=function(t){t.uniforms.rotation4D=e,t.vertexShader="\n      attribute uint axis;\n      attribute float len;\n      attribute float height;\n      uniform float rotation4D[6];\n\n      ".concat(j,"\n      ").concat(D,"\n      ").concat(t.vertexShader,"\n    "),t.vertexShader=t.vertexShader.replace("#include <begin_vertex>","\n      #include <begin_vertex>\n      // 同 axisMaterial，但是底部坐标变成了坐标轴圆柱的结束坐标。\n      vec4 v = vec4(0.0);\n      if (axis == 0u) v.x = 1.0;\n      else if (axis == 1u) v.y = 1.0;\n      else if (axis == 2u) v.z = 1.0;\n      else if (axis == 3u) v.w = 1.0;\n      vec3 vProj = (create4DRotationMat(rotation4D) * v).xyz;\n      float s = length(vProj) / length(v);\n      float scale1 = len / length(vProj) * s;\n      float scale2 = (len * s + height) / length(vProj);\n      vec3 vProj1 = vProj * scale1;\n      vec3 vProj2 = vProj * scale2;\n      transformed = transformCylinderPoint(position + vec3(0.0, 0.5, 0.0), vProj1, vProj2);\n      ")},t},axisLabelMaterial:function(t,e){return(t=t.clone()).onBeforeCompile=function(t){t.uniforms.rotation4D=e,t.vertexShader="\n      attribute uint axis;\n      attribute float len;\n      attribute float offset;\n      uniform float rotation4D[6];\n\n      ".concat(j,"\n      ").concat(D,"\n      ").concat(t.vertexShader,"\n    "),t.vertexShader=t.vertexShader.replace("#include <begin_vertex>","\n      #include <begin_vertex>\n      // 类似 axisCone，但是往坐标轴方向上偏移了一些。\n      vec4 v = vec4(0.0);\n      if (axis == 0u) v.x = 1.0;\n      else if (axis == 1u) v.y = 1.0;\n      else if (axis == 2u) v.z = 1.0;\n      else if (axis == 3u) v.w = 1.0;\n      vec3 vProj = (create4DRotationMat(rotation4D) * v).xyz;\n      float s = length(vProj) / length(v);\n      float scale1 = (len * s + offset) / length(vProj);\n      float scale2 = (len * s + offset + 1.0) / length(vProj);\n      vec3 vProj1 = vProj * scale1;\n      vec3 vProj2 = vProj * scale2;\n      transformed = transformCylinderPoint(position + vec3(0.0, 0.5, 0.0), vProj1, vProj2);\n      ")},t}};var O=r(543);function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}function P(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function z(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=E(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==E(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function A(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return L(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function L(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function M(t){var e;return e=t.reduce((function(t,e){var r=e.x**2+e.y**2+e.z**2;return r>(t.dist||-1)?{point:e,dist:r}:t}),{}).point,Math.sqrt(e.x**2+e.y**2+e.z**2)}function G(t,e,r){t&&t.traverse((function(t){if(t.isMesh&&t.material)if(Array.isArray(t.material)){var n,i=A(t.material);try{for(i.s();!(n=i.n()).done;){var o=n.value;(0,O.set)(o,e,r),o.needsUpdate=!0}}catch(t){i.e(t)}finally{i.f()}}else(0,O.set)(t.material,e,r),t.material.needsUpdate=!0}))}function F(t){var e=new m.LoY;return["position","normal","uv"].forEach((function(r){return t.attributes[r]&&e.setAttribute(r,t.attributes[r].clone())})),t.index&&e.setIndex(t.index.clone()),t.parameters&&(e.parameters=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?P(Object(r),!0).forEach((function(e){z(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t.parameters)),t.dispose(),e}const k=r.p+"assets/Sarasa_Mono_SC_Bold.typeface.json";function I(t){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I(t)}function R(){R=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function u(t,e,r,n){var o=e&&e.prototype instanceof m?e:m,a=Object.create(o.prototype),s=new A(n||[]);return i(a,"_invoke",{value:O(t,r,s)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var h="suspendedStart",d="suspendedYield",p="executing",v="completed",y={};function m(){}function w(){}function g(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,S=x&&x(x(L([])));S&&S!==r&&n.call(S,a)&&(b=S);var j=g.prototype=m.prototype=Object.create(b);function D(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function r(i,o,a,s){var c=f(t[i],t,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==I(u)&&n.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(u).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return o=o?o.then(i,i):i()}})}function O(e,r,n){var i=h;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===v){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===h)throw i=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=f(e,r,n);if("normal"===l.type){if(i=n.done?v:d,l.arg===y)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=v,n.method="throw",n.arg=l.arg)}}}function E(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,E(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var o=f(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function z(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function L(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(I(e)+" is not iterable")}return w.prototype=g,i(j,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:w,configurable:!0}),w.displayName=l(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,c,"GeneratorFunction")),t.prototype=Object.create(j),t},e.awrap=function(t){return{__await:t}},D(_.prototype),l(_.prototype,s,(function(){return this})),e.AsyncIterator=_,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new _(u(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},D(j),l(j,c,"Generator"),l(j,a,(function(){return this})),l(j,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=L,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(z),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),z(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;z(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:L(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function U(t,e,r,n,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,i)}function V(t){return new m._4j({color:t,roughness:.3,metalness:0,flatShading:!0})}function C(t){return new Promise((function(e,r){(new b.J).load(t,(function(t){return e(t)}),void 0,(function(t){return r(t)}))}))}function T(t,e,r){for(var n=F(new m.Ho_(.5,.5,1,10)),i=n.attributes.position.count,o=new Uint32Array(i),a=new Float32Array(i),s=0;s<i;s++)o[s]=t,a[s]=50;n.setAttribute("axis",new m.MW4(o,1)),n.setAttribute("len",new m.qtW(a,1));var c=V(e);return c=_.axisMaterial(c,r),new m.eaF(n,c)}function B(t,e,r){for(var n=F(new m.qFE(2,1,10)),i=n.attributes.position.count,o=new Uint32Array(i),a=new Float32Array(i),s=new Float32Array(i),c=0;c<i;c++)o[c]=t,a[c]=50,s[c]=6;n.setAttribute("axis",new m.MW4(o,1)),n.setAttribute("len",new m.qtW(a,1)),n.setAttribute("height",new m.qtW(s,1));var l=V(e);return l=_.axisConeMaterial(l,r),new m.eaF(n,l)}function N(t,e,r,n,i){var o=F(new x._(r,{font:n,size:5,depth:1,curveSegments:12}));o.computeBoundingBox(),o.center();for(var a=o.attributes.position.count,s=new Uint32Array(a),c=new Float32Array(a),l=new Float32Array(a),u=0;u<a;u++)s[u]=t,c[u]=50,l[u]=13;o.setAttribute("axis",new m.MW4(s,1)),o.setAttribute("len",new m.qtW(c,1)),o.setAttribute("offset",new m.qtW(l,1));var f=V(e);return f=_.axisLabelMaterial(f,i),new m.eaF(o,f)}function W(){var t;return t=R().mark((function t(e,r){var n,i,o,a,s,c,l,u,f,h,d,p,v,y;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C(k);case 2:return n=t.sent,i=new m.YJl,o=T(0,16711680,r),a=B(0,16711680,r),s=N(0,16711680,"X",n,r),c=T(1,65280,r),l=B(1,65280,r),u=N(1,65280,"Y",n,r),f=T(2,255,r),h=B(2,255,r),d=N(2,255,"Z",n,r),p=T(3,15757350,r),v=B(3,15757350,r),y=N(3,15757350,"W",n,r),i.add(o,a,s),i.add(c,l,u),i.add(f,h,d),i.add(p,v,y),e.add(i),t.abrupt("return",i);case 22:case"end":return t.stop()}}),t)})),W=function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function a(t){U(o,n,i,a,s,"next",t)}function s(t){U(o,n,i,a,s,"throw",t)}a(void 0)}))},W.apply(this,arguments)}const q=function(t,e){return W.apply(this,arguments)};r(312),r(4);function Y(t){return function(t){if(Array.isArray(t))return X(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Z(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,a,s=[],c=!0,l=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);c=!0);}catch(t){l=!0,i=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(t,e)||Z(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(t,e){if(t){if("string"==typeof t)return X(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?X(t,e):void 0}}function X(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function H(t){var e=t.split("\n").filter((function(t){return""!==t.trim()&&!t.startsWith("#")}));if("OFF"!==e[0].trim())throw new Error("Invalid OFF file format");for(var r=$(e[1].trim().split(/\s+/).map(Number),2),n=r[0],i=r[1],o=[],a=0;a<n;a++){var s=$(e[a+2].trim().split(/\s+/).map(parseFloat),3),c=s[0],l=s[1],u=s[2];o.push({x:c,y:l,z:u})}for(var f=[],h=0;h<i;h++){var d=e[h+2+n].trim().split(/\s+/),p=parseInt(d[0]);f.push(d.slice(1,p+1).map(Number))}var v=J(f).map((function(t){return t.map((function(t){return o[t]}))}));return{vertices:o,faces:f,edges:v}}function J(t){var e=t.flatMap((function(t){return t.map((function(e,r){return[Math.min(e,t[(r+1)%t.length]),Math.max(e,t[(r+1)%t.length])]}))}));return Y(new Set(e.map(JSON.stringify))).map(JSON.parse)}function K(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,a,s=[],c=!0,l=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);c=!0);}catch(t){l=!0,i=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(t,e)||Q(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Q(t,e){if(t){if("string"==typeof t)return tt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?tt(t,e):void 0}}function tt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function et(t){var e=t.split("\n").filter((function(t){return""!==t.trim()&&!t.startsWith("#")}));if("4OFF"!==e[0].trim())throw new Error("Invalid 4OFF file format");for(var r=K(e[1].trim().split(/\s+/).map(Number),4),n=r[0],i=r[1],o=r[3],a=[],s=0;s<n;s++){var c=K(e[s+2].trim().split(/\s+/).map(parseFloat),4),l=c[0],u=c[1],f=c[2],h=c[3];a.push({x:l,y:u,z:f,w:h})}for(var d=[],p=0;p<i;p++){var v=e[p+2+n].trim().split(/\s+/),y=parseInt(v[0]);d.push(v.slice(1,y+1).map(Number))}for(var m=[],w=0;w<o;w++){var g=e[w+2+n+i].trim().split(/\s+/),b=parseInt(g[0]);m.push(g.slice(1,b+1).map(Number))}var x=J(d).map((function(t){return t.map((function(t){return a[t]}))}));return{vertices:a,faces:d,edges:x,cells:m}}const rt=r.p+"assets/Small_stellated_dodecahedron.off";function nt(t){return nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nt(t)}function it(t){return function(t){if(Array.isArray(t))return st(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||at(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ot(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,a,s=[],c=!0,l=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);c=!0);}catch(t){l=!0,i=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(t,e)||at(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function at(t,e){if(t){if("string"==typeof t)return st(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?st(t,e):void 0}}function st(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ct(){ct=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function u(t,e,r,n){var o=e&&e.prototype instanceof m?e:m,a=Object.create(o.prototype),s=new A(n||[]);return i(a,"_invoke",{value:O(t,r,s)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var h="suspendedStart",d="suspendedYield",p="executing",v="completed",y={};function m(){}function w(){}function g(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,S=x&&x(x(L([])));S&&S!==r&&n.call(S,a)&&(b=S);var j=g.prototype=m.prototype=Object.create(b);function D(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function r(i,o,a,s){var c=f(t[i],t,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==nt(u)&&n.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(u).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return o=o?o.then(i,i):i()}})}function O(e,r,n){var i=h;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===v){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===h)throw i=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=f(e,r,n);if("normal"===l.type){if(i=n.done?v:d,l.arg===y)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=v,n.method="throw",n.arg=l.arg)}}}function E(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,E(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var o=f(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function z(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function L(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(nt(e)+" is not iterable")}return w.prototype=g,i(j,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:w,configurable:!0}),w.displayName=l(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,c,"GeneratorFunction")),t.prototype=Object.create(j),t},e.awrap=function(t){return{__await:t}},D(_.prototype),l(_.prototype,s,(function(){return this})),e.AsyncIterator=_,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new _(u(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},D(j),l(j,c,"Generator"),l(j,a,(function(){return this})),l(j,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=L,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(z),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),z(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;z(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:L(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function lt(t,e,r,n,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,i)}function ut(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function a(t){lt(o,n,i,a,s,"next",t)}function s(t){lt(o,n,i,a,s,"throw",t)}a(void 0)}))}}function ft(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ht(n.key),n)}}function ht(t){var e=function(t,e){if("object"!=nt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=nt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==nt(e)?e:e+""}var dt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.faceVisibleSwitcher=null,this.wireframeVisibleSwitcher=null,this.verticesVisibleSwitcher=null,this.axisVisibleSwitcher=null,this.perspSwitcher=null,this.schleSwitcher=null,this.scaleFactorSlider=null,this.facesOpacitySlider=null,this.wireframeAndVerticesDimSlider=null,this.projectionDistanceSlider=null,this.fileInput=null,this.infoDis=null,this.progDis=null,this.rotationSliders=[],this.scaleFactor=1,this.axesGroup=null,this.solidGroup=null,this.facesGroup=null,this.wireframeGroup=null,this.verticesGroup=null,this.is4D=!1,this.rotUni={value:[0,0,0,0,0,0]},this.projDistUni={value:2},this.isOrthoUni={value:0},this.cylinderRadiusUni={value:.5},this.sphereRadiusUni={value:1},this.renderer=null,this.scene=null,this.cameraPersp=null,this.cameraOrtho=null,this.camera=null,this.controls=null,this.init()},e=[{key:"init",value:(c=ut(ct().mark((function t(){var e;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._initializeDomElements(),this._initializeRenderer(),this._initializeScene(),this._initializeCameras(),this._initializeLights(),this._initializeControls(),t.next=8,q(this.scene,this.rotUni);case 8:return this.axesGroup=t.sent,e=new m.tXL({color:5592405,specular:2236962,shininess:50,flatShading:!0}),t.next=12,this.loadMeshFromUrl(rt,e);case 12:this.setupEventListeners(),this.renderer.setAnimationLoop(this.render.bind(this));case 14:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"_initializeDomElements",value:function(){this.faceVisibleSwitcher=document.getElementById("faceVisibleSwitcher"),this.wireframeVisibleSwitcher=document.getElementById("wireframeVisibleSwitcher"),this.verticesVisibleSwitcher=document.getElementById("verticesVisibleSwitcher"),this.axisVisibleSwitcher=document.getElementById("axisVisibleSwitcher"),this.perspSwitcher=document.getElementById("perspSwitcher"),this.schleSwitcher=document.getElementById("schleSwitcher"),this.scaleFactorSlider=document.getElementById("scaleFactorSlider"),this.facesOpacitySlider=document.getElementById("facesOpacitySlider"),this.wireframeAndVerticesDimSlider=document.getElementById("wireframeAndVerticesDimSlider"),this.projectionDistanceSlider=document.getElementById("projectionDistanceSlider"),this.fileInput=document.getElementById("fileInput"),this.infoDis=document.getElementById("info"),this.progDis=document.getElementById("prog"),this.rotationSliders=["XY","XZ","XW","YZ","YW","ZW"].map((function(t){return document.getElementById("rot".concat(t,"Slider"))}))}},{key:"_initializeRenderer",value:function(){var t=this,e=window.devicePixelRatio||1,r=document.getElementById("polyhedronRenderer");this.renderer=new w.JeP({antialias:!0,powerPreference:"high-performance",canvas:r});var n=Math.min(Math.min(window.innerWidth,window.innerHeight)-16,720);this.renderer.setSize(n*e,n*e,!1),r.style.width="".concat(n,"px"),r.style.height="".concat(n,"px"),r.style.display="block",window.addEventListener("resize",(function(){var n=Math.min(Math.min(window.innerWidth,window.innerHeight)-16,720);t.renderer.setSize(n*e,n*e,!1),r.style.width="".concat(n,"px"),r.style.height="".concat(n,"px")}))}},{key:"_initializeScene",value:function(){this.scene=new m.Z58,this.scene.background=new m.Q1f(1118481)}},{key:"_initializeCameras",value:function(){this.cameraPersp=new m.ubm(60,1,.01,500),this.cameraOrtho=new m.qUd(-60,60,60,-60,.01,500),this.cameraPersp.position.set(0,0,120),this.cameraOrtho.position.set(0,0,120),this.camera=this.cameraPersp.clone()}},{key:"_initializeLights",value:function(){var t=new m.ZyN(16777215);t.position.set(.5,.6,.4).normalize(),t.intensity=7,t.castShadow=!0,t.shadow.mapSize.width=2048,t.shadow.mapSize.height=2048,this.scene.add(t);var e=new m.$p8(2236962);e.intensity=100,this.scene.add(e);var r=new m.ZyN(14540266,.9);r.intensity=8,r.position.set(-.5,-.6,-.4).normalize(),r.castShadow=!0,r.shadow.mapSize.width=2048,r.shadow.mapSize.height=2048,this.scene.add(r)}},{key:"_initializeControls",value:function(){this.controls=new g.V(this.camera,this.renderer.domElement),this.controls.dynamicDampingFactor=.8,this.controls.rotateSpeed=4,this.controls.maxDistance=150,this.controls.minDistance=.1}},{key:"render",value:function(){this.controls.update(),this.renderer.render(this.scene,this.camera)}},{key:"createWireframeAndVertices",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.cylinderMaterial,n=e.sphereMaterial,i=e.cylinderColor,o=void 0===i?12632256:i,a=e.sphereColor,s=void 0===a?16766720:a,c=r||new m._4j({color:o,metalness:1,roughness:.4}),l=n||new m._4j({color:s,metalness:1,roughness:.5});c=_.cylinderMaterial3D(c,this.cylinderRadiusUni),l=_.sphereMaterial3D(l,this.sphereRadiusUni);var u=new m.Ho_(1,1,1,8,1,!1),f=new m.ZLX(u,c,t.length),h=new m.Gu$(1,16,16),d=new m.ZLX(h,l,2*t.length);d.count=0;var p=new Set,v=new m.B69;t.forEach((function(t,e){var r=ot(t,2),n=r[0],i=r[1],o="".concat(n.x,",").concat(n.y,",").concat(n.z),a="".concat(i.x,",").concat(i.y,",").concat(i.z),s=new m.Pq0(n.x,n.y,n.z),c=new m.Pq0(i.x,i.y,i.z),l=(new m.Pq0).subVectors(c,s),u=l.length();v.position.copy((new m.Pq0).addVectors(s,c).multiplyScalar(.5)),v.quaternion.setFromUnitVectors(new m.Pq0(0,1,0),l.clone().normalize()),v.scale.set(1,u,1),v.updateMatrix(),f.setMatrixAt(e,v.matrix),p.has(o)||(v.position.copy(s),v.scale.set(1,1,1),v.quaternion.identity(),v.updateMatrix(),d.setMatrixAt(d.count++,v.matrix),p.add(o)),p.has(a)||(v.position.copy(c),v.scale.set(1,1,1),v.quaternion.identity(),v.updateMatrix(),d.setMatrixAt(d.count++,v.matrix),p.add(a))})),f.instanceMatrix.needsUpdate=!0,d.instanceMatrix.needsUpdate=!0;var y=new m.YJl,w=new m.YJl;return y.add(f),w.add(d),{wireframeGroup:y,verticesGroup:w}}},{key:"create4DWireframeAndVertices",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.cylinderMaterial,n=e.sphereMaterial,i=e.cylinderColor,o=void 0===i?12632256:i,a=e.sphereColor,s=void 0===a?16766720:a,c=r||new m._4j({color:o,metalness:1,roughness:.4,side:m.$EB}),l=n||new m._4j({color:s,metalness:1,roughness:.5});c=_.cylinderMaterial(c,this.cylinderRadiusUni,this.rotUni,this.projDistUni,this.isOrthoUni),l=_.sphereMaterial(l,this.sphereRadiusUni,this.rotUni,this.projDistUni,this.isOrthoUni);var u=new m.YJl,f=new m.YJl,h=new Set,d=new Float32Array(4*t.length),p=new Float32Array(4*t.length),v=[];t.forEach((function(t,e){var r=ot(t,2),n=r[0],i=r[1],o="".concat(n.x,",").concat(n.y,",").concat(n.z,",").concat(n.w),a="".concat(i.x,",").concat(i.y,",").concat(i.z,",").concat(i.w);d.set(Object.values(n),4*e),p.set(Object.values(i),4*e),h.has(o)||(v.push(Object.values(n)),h.add(o)),h.has(a)||(v.push(Object.values(i)),h.add(a))}));var y=F(new m.Ho_(1,1,1,5));y.setAttribute("v1",new m.uWO(d,4)),y.setAttribute("v2",new m.uWO(p,4));var w=new m.ZLX(y,c,t.length);u.add(w);var g=F(new m.Gu$(1,5,5));g.setAttribute("center4D",new m.uWO(new Float32Array(v.flat()),4));var b=new m.ZLX(g,l,v.length);return f.add(b),{wireframeGroup:u,verticesGroup:f}}},{key:"loadMesh",value:function(t,e){var r=new m.B69,n=new m.LoY,i=new Float32Array(3*t.vertices.length);t.vertices.forEach((function(t,e){i[3*e]=t.x,i[3*e+1]=t.y,i[3*e+2]=t.z})),n.setAttribute("position",new m.THS(i,3));var o=[];t.faces.forEach((function(t){return o.push.apply(o,it(t))})),n.setIndex(o),n.computeVertexNormals();var a=new m.eaF(n,e);a.material.side=m.$EB,this.updateScaleFactor(40/M(t.vertices));var s=this.createWireframeAndVertices(t.edges),c=s.wireframeGroup,l=s.verticesGroup;return r.add(a),r.add(c),r.add(l),r.scale.setScalar(this.scaleFactor),this.scene.add(r),this.render(),{scaleFactor:this.scaleFactor,solidGroup:r,facesGroup:a,wireframeGroup:c,verticesGroup:l}}},{key:"load4DMesh",value:function(t,e){var r=this,n=new m.B69,i=new m.LoY,o=new Float32Array(3*t.vertices.length);t.vertices.forEach((function(t,e){o[3*e]=t.x,o[3*e+1]=t.y,o[3*e+2]=t.z})),i.setAttribute("position",new m.THS(o,3));var a=new Float32Array(4*t.vertices.length);t.vertices.forEach((function(t,e){a[4*e]=t.x,a[4*e+1]=t.y,a[4*e+2]=t.z,a[4*e+3]=t.w})),i.setAttribute("position4D",new m.THS(a,4));var s=[];t.faces.forEach((function(t){return s.push.apply(s,it(t))})),i.setIndex(s),i.computeVertexNormals();var c,l,u=new m.eaF(i,e);u.material.side=m.$EB,this.projectionDistanceSlider.value=1.1*(c=t.vertices,l=c.reduce((function(t,e){var r=e.x**2+e.y**2+e.z**2+e.w**2;return r>(t.dist||-1)?{point:e,dist:r}:t}),{}).point,Math.sqrt(l.x**2+l.y**2+l.z**2+l.w**2)),this.updateProjectionDistance(),this.updateScaleFactor(40/M(t.vertices.map((function(t){if(!r.schleSwitcher.checked)return{x:t.x,y:t.y,z:t.z};var e=+r.projectionDistanceSlider.value,n=e/(e+t.w);return{x:t.x*n,y:t.y*n,z:t.z*n}}))));var f=this.create4DWireframeAndVertices(t.edges),h=f.wireframeGroup,d=f.verticesGroup;return n.add(u),n.add(h),n.add(d),n.scale.setScalar(this.scaleFactor),this.scene.add(n),this.render(),{scaleFactor:this.scaleFactor,solidGroup:n,facesGroup:u,wireframeGroup:h,verticesGroup:d}}},{key:"processMeshData",value:(s=ut(ct().mark((function t(e){var n,i=this,o=arguments;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]&&o[1],t.abrupt("return",new Promise((function(t,o){var a=new Worker(new URL(r.p+r.u(362),r.b));a.postMessage({meshData:e,is4D:n}),a.addEventListener("message",(function(e){var r=e.data,n=r.type,s=r.data;switch(n){case"progress":i.progDis.innerText="加载进度：".concat(s.toFixed(2),"%");break;case"complete":a.terminate(),i.progDis.innerText="",t(s);break;case"error":a.terminate(),i.progDis.innerText="",o(s)}}))})));case 2:case"end":return t.stop()}}),t)}))),function(t){return s.apply(this,arguments)})},{key:"loadMeshFromOffData",value:(a=ut(ct().mark((function t(e,r){var n,i,o,a,s,c,l,u,f;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=H(e),t.next=3,this.processMeshData(n);case 3:i=t.sent,o="\n    顶点数：".concat(n.vertices.length,"\n    边数：").concat(n.edges.length,"\n    面数：").concat(n.faces.length,"\n    ").trim().replace(" ",""),this.infoDis.innerText=o,a=this.loadMesh(i,r),s=a.scaleFactor,c=a.solidGroup,l=a.facesGroup,u=a.wireframeGroup,f=a.verticesGroup,this.scaleFactor=s,this.solidGroup=c,this.facesGroup=l,this.wireframeGroup=u,this.verticesGroup=f,this.updateProperties();case 13:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})},{key:"loadMeshFrom4OffData",value:(o=ut(ct().mark((function t(e,r){var n,i,o,a,s,c,l,u,f;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=et(e),t.next=3,this.processMeshData(n,!0);case 3:i=t.sent,o="\n    顶点数：".concat(n.vertices.length,"\n    边数：").concat(n.edges.length,"\n    面数：").concat(n.faces.length,"\n    胞数：").concat(n.cells.length,"\n    ").trim().replace(" ",""),this.infoDis.innerText=o,r=_.faceMaterial(r,this.rotUni,this.projDistUni,this.isOrthoUni),a=this.load4DMesh(i,r),s=a.scaleFactor,c=a.solidGroup,l=a.facesGroup,u=a.wireframeGroup,f=a.verticesGroup,this.scaleFactor=s,this.solidGroup=c,this.facesGroup=l,this.wireframeGroup=u,this.verticesGroup=f,this.updateProperties(),this.updateProjectionDistance(),this.updateRotation();case 16:case"end":return t.stop()}}),t,this)}))),function(t,e){return o.apply(this,arguments)})},{key:"loadMeshFromUrl",value:(i=ut(ct().mark((function t(e,r){var n=this;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){fetch(e).then((function(t){if(!t.ok)throw new Error("网络响应不正常");return t.text()})).then(function(){var e=ut(ct().mark((function e(i){return ct().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.loadMeshFromOffData(i,r);case 2:t();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})));case 1:case"end":return t.stop()}}),t)}))),function(t,e){return i.apply(this,arguments)})},{key:"updateProperties",value:function(){G(this.facesGroup,"visible",this.faceVisibleSwitcher.checked),G(this.wireframeGroup,"visible",this.wireframeVisibleSwitcher.checked),G(this.verticesGroup,"visible",this.verticesVisibleSwitcher.checked),G(this.axesGroup,"visible",this.axisVisibleSwitcher.checked),G(this.facesGroup,"opacity",+this.facesOpacitySlider.value),G(this.facesGroup,"transparent",1!=+this.facesOpacitySlider.value),this.cylinderRadiusUni.value=+this.wireframeAndVerticesDimSlider.value/this.scaleFactor,this.sphereRadiusUni.value=+this.wireframeAndVerticesDimSlider.value/this.scaleFactor*2}},{key:"updateProjectionDistance",value:function(){this.projDistUni.value=+this.projectionDistanceSlider.value}},{key:"updateRotation",value:function(){var t=this.rotationSliders.map((function(t){return+t.value}));this.rotUni.value=t,this.is4D||this.solidGroup&&(this.solidGroup.rotation.x=t[3]*(Math.PI/-180),this.solidGroup.rotation.y=t[1]*(Math.PI/180),this.solidGroup.rotation.z=t[0]*(Math.PI/-180))}},{key:"updateScaleFactor",value:function(t){this.scaleFactor=t,this.scaleFactorSlider.value=t,this.cylinderRadiusUni.value=+this.wireframeAndVerticesDimSlider.value/t,this.sphereRadiusUni.value=+this.wireframeAndVerticesDimSlider.value/t*2,this.solidGroup&&this.solidGroup.scale.setScalar(t)}},{key:"toggleCamera",value:function(){var t=this.perspSwitcher.checked,e=this.camera.clone();t?(this.camera=this.cameraPersp.clone(),this.camera.position.copy(e.position),this.camera.rotation.copy(e.rotation),this.camera.quaternion.copy(e.quaternion)):(this.camera=this.cameraOrtho.clone(),this.camera.position.copy(e.position),this.camera.rotation.copy(e.rotation),this.camera.quaternion.copy(e.quaternion)),this.controls.object=this.camera}},{key:"setupEventListeners",value:function(){var t=this;this.faceVisibleSwitcher.addEventListener("change",(function(){return G(t.facesGroup,"visible",t.faceVisibleSwitcher.checked)})),this.wireframeVisibleSwitcher.addEventListener("change",(function(){return G(t.wireframeGroup,"visible",t.wireframeVisibleSwitcher.checked)})),this.verticesVisibleSwitcher.addEventListener("change",(function(){return G(t.verticesGroup,"visible",t.verticesVisibleSwitcher.checked)})),this.axisVisibleSwitcher.addEventListener("change",(function(){return G(t.axesGroup,"visible",t.axisVisibleSwitcher.checked)})),this.scaleFactorSlider.addEventListener("input",(function(){return t.updateScaleFactor(+t.scaleFactorSlider.value)})),this.facesOpacitySlider.addEventListener("input",(function(){G(t.facesGroup,"opacity",+t.facesOpacitySlider.value),G(t.facesGroup,"transparent",1!=+t.facesOpacitySlider.value)})),this.wireframeAndVerticesDimSlider.addEventListener("input",(function(){t.cylinderRadiusUni.value=+t.wireframeAndVerticesDimSlider.value/t.scaleFactor,t.sphereRadiusUni.value=+t.wireframeAndVerticesDimSlider.value/t.scaleFactor*2})),this.projectionDistanceSlider.addEventListener("input",this.updateProjectionDistance.bind(this)),this.rotationSliders.forEach((function(e,r){e.addEventListener("input",(function(){t.rotUni.value[r]=+e.value,!t.is4D&&t.solidGroup&&(3===r?t.solidGroup.rotation.x=+e.value*(Math.PI/-180):1===r?t.solidGroup.rotation.y=+e.value*(Math.PI/180):0===r&&(t.solidGroup.rotation.z=+e.value*(Math.PI/-180)))}))})),this.perspSwitcher.addEventListener("change",this.toggleCamera.bind(this)),this.schleSwitcher.addEventListener("change",(function(){return t.isOrthoUni.value=!t.schleSwitcher.checked})),this.fileInput.addEventListener("change",this.handleFileInputChange.bind(this))}},{key:"handleFileInputChange",value:function(t){var e=this,r=t.target.files[0];if(r){var n=new FileReader;n.onload=function(){var t=ut(ct().mark((function t(r){var n,i;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.target.result,e.solidGroup&&((o=e.solidGroup).traverse((function(t){var e,r;t.isMesh&&(null===(e=t.geometry)||void 0===e||e.dispose(),null===(r=t.material)||void 0===r||r.dispose())})),o.clear(),e.scene.remove(e.solidGroup)),e.is4D="4OFF"===n.split("\n").filter((function(t){return""!==t.trim()&&!t.startsWith("#")}))[0].trim(),i=new m.tXL({color:5592405,specular:2236962,shininess:50,flatShading:!0}),!e.is4D){t.next=13;break}e.loadMeshFrom4OffData(n,i),e.projectionDistanceSlider.disabled=!1,e.schleSwitcher.disabled=!1,e.rotationSliders[2].disabled=!1,e.rotationSliders[4].disabled=!1,e.rotationSliders[5].disabled=!1,t.next=24;break;case 13:return t.next=15,e.loadMeshFromOffData(n,i);case 15:e.projectionDistanceSlider.disabled=!0,e.schleSwitcher.disabled=!0,e.rotationSliders[2].disabled=!0,e.rotationSliders[4].disabled=!0,e.rotationSliders[5].disabled=!0,e.rotationSliders[2].value=0,e.rotationSliders[4].value=0,e.rotationSliders[5].value=0,e.updateRotation();case 24:case"end":return t.stop()}var o}),t)})));return function(e){return t.apply(this,arguments)}}(),n.readAsText(r)}}}],e&&ft(t.prototype,e),n&&ft(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,i,o,a,s,c}();document.addEventListener("DOMContentLoaded",(function(){return new dt}))}},r={};function n(t){var i=r[t];if(void 0!==i)return i.exports;var o=r[t]={id:t,loaded:!1,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,t=[],n.O=(e,r,i,o)=>{if(!r){var a=1/0;for(u=0;u<t.length;u++){for(var[r,i,o]=t[u],s=!0,c=0;c<r.length;c++)(!1&o||a>=o)&&Object.keys(n.O).every((t=>n.O[t](r[c])))?r.splice(c--,1):(s=!1,o<a&&(a=o));if(s){t.splice(u--,1);var l=i();void 0!==l&&(e=l)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[r,i,o]},n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.u=t=>"js/"+t+".chunk.js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),n.j=57,(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&(!t||!/^http(s?):/.test(t));)t=r[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t+"../"})(),(()=>{n.b=document.baseURI||self.location.href;var t={57:0};n.O.j=e=>0===t[e];var e=(e,r)=>{var i,o,[a,s,c]=r,l=0;if(a.some((e=>0!==t[e]))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(c)var u=c(n)}for(e&&e(r);l<a.length;l++)o=a[l],n.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return n.O(u)},r=self.webpackChunk=self.webpackChunk||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})(),n.nc=void 0;var i=n.O(void 0,[96],(()=>n(692)));i=n.O(i)})();