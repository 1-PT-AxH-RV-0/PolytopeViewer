/*! For license information please see index.js.LICENSE.txt */
(()=>{var e,t,r,n,o={1208:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(1601),o=r.n(n),i=r(6314),a=r.n(i)()(o());a.push([e.id,"body {\n  margin: 0;\n  font-family:\n    monospace,\n    system-ui,\n    -apple-system,\n    BlinkMacSystemFont,\n    'Segoe UI',\n    Roboto,\n    Oxygen,\n    Ubuntu,\n    Cantarell,\n    'Open Sans',\n    'Helvetica Neue',\n    sans-serif;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  height: 100dvh;\n  width: 100dvw;\n  overflow: hidden;\n}\n\n@media (min-aspect-ratio: 1/1) {\n  body {\n    flex-direction: row;\n  }\n}\n\n@media (max-aspect-ratio: 1/1) {\n  body {\n    flex-direction: column;\n  }\n}\n\n.polytope-renderer {\n  display: block;\n}\n\n.tabs {\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  overflow: auto;\n}\n\n.controls {\n  overflow: auto;\n  padding: 8px;\n  flex-grow: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n\n.sele-off {\n  display: none;\n  padding: 8px;\n  overflow: auto;\n  flex-grow: 1;\n}\n\n.inf-families-container {\n  display: flex;\n  align-items: center;\n}\n\n.gen-inf-families {\n  margin-right: 4px;\n}\n\n.inf-family-params {\n  width: 2em;\n}\n\n.nav {\n  display: flex;\n  background-color: black;\n  gap: 1px;\n  height: 1.5rem;\n  width: 100%;\n}\n\n.nav > div {\n  flex: 1 0 0;\n  height: 100%;\n  background-color: white;\n  text-align: center;\n}\n\n.nav > div.active {\n  background-color: #bbb;\n}\n\n.file-input {\n  display: none;\n}\n\n.config-file-input {\n  display: none;\n}\n\n.info {\n  position: absolute;\n  left: 4px;\n  top: 4px;\n  font-size: 0.5rem;\n  color: white;\n  pointer-events: none;\n}\n\n.prog-container {\n  position: absolute;\n  transform: translate(-50%, -50%);\n  pointer-events: none;\n}\n\n.prog {\n  text-align: center;\n  font-size: 2rem;\n  color: white;\n}\n\n.nanobar {\n  border: solid 1px white;\n  height: 12px;\n  margin: 0 auto;\n}\n\n.bar {\n  background-color: #25c4d3;\n}\n",""]);const s=a},7074:(e,t,r)=>{var n={"./polychora/BitruncatedRegularConvex/Bitruncated_hecatonicosachoron.off":[68,68],"./polychora/BitruncatedRegularConvex/Bitruncated_icositetrachoron.off":[6402,6402],"./polychora/BitruncatedRegularConvex/Bitruncated_pentachoron.off":[3753,3753],"./polychora/BitruncatedRegularConvex/Bitruncated_tesseract.off":[5794,5794],"./polychora/BitruncatedSchläfliHess/Dahi(btga120).off":[6461,6461],"./polychora/BitruncatedSchläfliHess/Gixhi(btgags120).off":[5404,5404],"./polychora/BitruncatedSchläfliHess/Shihi(btf600).off":[323,323],"./polychora/CantellatedRegularConvex/Cantellated_hecatonicosachoron.off":[836,836],"./polychora/CantellatedRegularConvex/Cantellated_hexacosichoron.off":[2053,2053],"./polychora/CantellatedRegularConvex/Cantellated_icositetrachoron.off":[3842,3842],"./polychora/CantellatedRegularConvex/Cantellated_pentachoron.off":[6793,6793],"./polychora/CantellatedRegularConvex/Cantellated_tesseract.off":[5474,5474],"./polychora/CantellatedSchläfliHess/Sirfix.off":[8760,8760],"./polychora/CantellatedSchläfliHess/Sirgaghi.off":[5907,5907],"./polychora/CantellatedSchläfliHess/Sirgashi.off":[4255,4255],"./polychora/CantellatedSchläfliHess/Sirgax.off":[8413,8413],"./polychora/CantellatedSchläfliHess/Sirghi.off":[919,919],"./polychora/CantellatedSchläfliHess/Sirsashi.off":[7411,7411],"./polychora/CantellatedSchläfliHess/Sraghi.off":[5909,5909],"./polychora/CantitruncatedRegularConvex/Cantitruncated_hecatonicosachoron.off":[3850,3850],"./polychora/CantitruncatedRegularConvex/Cantitruncated_hexacosichoron.off":[4367,4367],"./polychora/CantitruncatedRegularConvex/Cantitruncated_icositetrachoron.off":[4384,4384],"./polychora/CantitruncatedRegularConvex/Cantitruncated_pentachoron.off":[4359,4359],"./polychora/CantitruncatedRegularConvex/Cantitruncated_tesseract.off":[7632,7632],"./polychora/CantitruncatedSchläfliHess/Girfix.off":[3552,3552],"./polychora/CantitruncatedSchläfliHess/Graggix.off":[1874,1874],"./polychora/CantitruncatedSchläfliHess/Graghi.off":[1709,1709],"./polychora/OmnitruncatedRegularConvex/Omnitruncated_hecatonicosachoron.off":[8120,8120],"./polychora/OmnitruncatedRegularConvex/Omnitruncated_icositetrachoron.off":[4638,4638],"./polychora/OmnitruncatedRegularConvex/Omnitruncated_pentachoron.off":[6245,6245],"./polychora/OmnitruncatedRegularConvex/Omnitruncated_tesseract.off":[7870,7870],"./polychora/RectifiedRegularConvex/Rectified_hecatonicosachoron.off":[8244,8244],"./polychora/RectifiedRegularConvex/Rectified_hexacosichoron.off":[2661,2661],"./polychora/RectifiedRegularConvex/Rectified_icositetrachoron.off":[4562,4562],"./polychora/RectifiedRegularConvex/Rectified_pentachoron.off":[153,153],"./polychora/RectifiedRegularConvex/Rectified_tesseract.off":[6946,6946],"./polychora/RectifiedSchläfliHess/Ragaghi.off":[9392,9392],"./polychora/RectifiedSchläfliHess/Ragashi.off":[7356,4975],"./polychora/RectifiedSchläfliHess/Raggix.off":[6257,6257],"./polychora/RectifiedSchläfliHess/Raghi.off":[6172,6172],"./polychora/RectifiedSchläfliHess/Ragishi.off":[5236,5236],"./polychora/RectifiedSchläfliHess/Rasishi.off":[7688,7688],"./polychora/RectifiedSchläfliHess/Rigfix.off":[8028,8028],"./polychora/RectifiedSchläfliHess/Righi.off":[1076,1076],"./polychora/RectifiedSchläfliHess/Rigogishi.off":[8026,8026],"./polychora/RectifiedSchläfliHess/Rofix.off":[5929,5929],"./polychora/RegularConvex/Hecatonicosachoron.off":[2561,2561],"./polychora/RegularConvex/Hexacosichoron.off":[3508,3508],"./polychora/RegularConvex/Hexadecachoron.off":[8455,8455],"./polychora/RegularConvex/Icositetrachoron.off":[2627,2627],"./polychora/RegularConvex/Pentachoron.off":[9186,9186],"./polychora/RegularConvex/Tesseract.off":[4305,4305],"./polychora/RuncinatedRegularConvex/Runcinated_hecatonicosachoron.off":[3226,3226],"./polychora/RuncinatedRegularConvex/Runcinated_icositetrachoron.off":[8400,8400],"./polychora/RuncinatedRegularConvex/Runcinated_pentachoron.off":[3799,3799],"./polychora/RuncinatedRegularConvex/Runcinated_tesseract.off":[6160,6160],"./polychora/RuncinatedSchläfliHess/Runcinated_facted_hexacosichoron.off":[286,286],"./polychora/RuncinatedSchläfliHess/Runcinated_great_grand_stellated_hecatonicosachoron.off":[4853,4853],"./polychora/RuncitruncatedRegularConvex/Runcitruncated_hecatonicosachoron.off":[1738,1738],"./polychora/RuncitruncatedRegularConvex/Runcitruncated_hexacosichoron.off":[575,575],"./polychora/RuncitruncatedRegularConvex/Runcitruncated_hexadecachoron.off":[1840,1840],"./polychora/RuncitruncatedRegularConvex/Runcitruncated_icositetrachoron.off":[5984,5984],"./polychora/RuncitruncatedRegularConvex/Runcitruncated_pentachoron.off":[5351,5351],"./polychora/RuncitruncatedRegularConvex/Runcitruncated_tesseract.off":[1056,1056],"./polychora/SchläfliHess/Fix.off":[9373,9373],"./polychora/SchläfliHess/Gaghi.off":[8702,8702],"./polychora/SchläfliHess/Gahi.off":[4067,4067],"./polychora/SchläfliHess/Gashi.off":[9106,9106],"./polychora/SchläfliHess/Gax.off":[1528,1528],"./polychora/SchläfliHess/Gishi.off":[5946,3565],"./polychora/SchläfliHess/Gofix.off":[1287,1287],"./polychora/SchläfliHess/Gogishi.off":[6400,6400],"./polychora/SchläfliHess/Gohi.off":[4053,4053],"./polychora/SchläfliHess/Sishi.off":[9774,9774],"./polychora/TruncatedRegularConvex/Tat.off":[7746,7746],"./polychora/TruncatedRegularConvex/Tex.off":[1554,1554],"./polychora/TruncatedRegularConvex/Thex.off":[4314,4314],"./polychora/TruncatedRegularConvex/Thi.off":[1884,1884],"./polychora/TruncatedRegularConvex/Tico.off":[4610,4610],"./polychora/TruncatedRegularConvex/Tip.off":[2118,2118],"./polychora/TruncatedSchläfliHess/Taggix.off":[1812,1812],"./polychora/TruncatedSchläfliHess/Taghi.off":[8631,8631],"./polychora/TruncatedSchläfliHess/Tiffix.off":[5006,2625],"./polychora/TruncatedSchläfliHess/Tigaghi.off":[1819,1819],"./polychora/TruncatedSchläfliHess/Tigfix.off":[3465,3465],"./polychora/TruncatedSchläfliHess/Tighi.off":[6975,6975],"./polyhedra/Archimedean/Cuboctahedron.off":[9879,9879],"./polyhedra/Archimedean/Great_rhombicosidodecahedron.off":[9867,9867],"./polyhedra/Archimedean/Great_rhombicuboctahedron.off":[3565,5946],"./polyhedra/Archimedean/Icosidodecahedron.off":[2719,2719],"./polyhedra/Archimedean/Small_rhombicosidodecahedron.off":[565,565],"./polyhedra/Archimedean/Small_rhombicuboctahedron.off":[3884,3884],"./polyhedra/Archimedean/Snub_cube.off":[5088,5088],"./polyhedra/Archimedean/Snub_dodecahedron.off":[5853,5853],"./polyhedra/Archimedean/Truncated_cube.off":[2222,2222],"./polyhedra/Archimedean/Truncated_dodecahedron.off":[351,351],"./polyhedra/Archimedean/Truncated_icosahedron.off":[7706,7706],"./polyhedra/Archimedean/Truncated_octahedron.off":[7330,7330],"./polyhedra/Archimedean/Truncated_tetrahedron.off":[2209,2209],"./polyhedra/Catalan/Deltoidal_hexecontahedron.off":[7039,7039],"./polyhedra/Catalan/Deltoidal_icositetrahedron.off":[2969,2969],"./polyhedra/Catalan/Disdyakis_dodecahedron.off":[2485,2485],"./polyhedra/Catalan/Disdyakis_triacontahedron.off":[2950,2950],"./polyhedra/Catalan/Pentagonal_hexecontahedron.off":[8248,8248],"./polyhedra/Catalan/Pentagonal_icositetrahedron.off":[2308,2308],"./polyhedra/Catalan/Pentakis_dodecahedron.off":[6003,6003],"./polyhedra/Catalan/Rhombic_dodecahedron.off":[5914,5914],"./polyhedra/Catalan/Rhombic_triacontahedron.off":[663,663],"./polyhedra/Catalan/Tetrakis_cube.off":[6690,6690],"./polyhedra/Catalan/Triakis_icosahedron.off":[2625,5006],"./polyhedra/Catalan/Triakis_octahedron.off":[3670,3670],"./polyhedra/Catalan/Triakis_tetrahedron.off":[2949,2949],"./polyhedra/Johnson/Augmented_dodecahedron.off":[9717,9717],"./polyhedra/Johnson/Augmented_hexagonal_prism.off":[2414,2414],"./polyhedra/Johnson/Augmented_pentagonal_prism.off":[7670,7670],"./polyhedra/Johnson/Augmented_sphenocorona.off":[8906,8906],"./polyhedra/Johnson/Augmented_triangular_prism.off":[6098,6098],"./polyhedra/Johnson/Augmented_tridiminished_icosahedron.off":[3264,3264],"./polyhedra/Johnson/Augmented_truncated_cube.off":[25,25],"./polyhedra/Johnson/Augmented_truncated_dodecahedron.off":[1408,1408],"./polyhedra/Johnson/Augmented_truncated_tetrahedron.off":[3228,847],"./polyhedra/Johnson/Biaugmented_pentagonal_prism.off":[493,493],"./polyhedra/Johnson/Biaugmented_triangular_prism.off":[829,829],"./polyhedra/Johnson/Biaugmented_truncated_cube.off":[9242,9242],"./polyhedra/Johnson/Bigyrate_diminished_rhombicosidodecahedron.off":[1546,1546],"./polyhedra/Johnson/Bilunabirotunda.off":[4013,4013],"./polyhedra/Johnson/Diminished_rhombicosidodecahedron.off":[9376,9376],"./polyhedra/Johnson/Disphenocingulum.off":[3614,3614],"./polyhedra/Johnson/Elongated_pentagonal_bipyramid.off":[5099,5099],"./polyhedra/Johnson/Elongated_pentagonal_cupola.off":[354,354],"./polyhedra/Johnson/Elongated_pentagonal_gyrobicupola.off":[3368,3368],"./polyhedra/Johnson/Elongated_pentagonal_gyrobirotunda.off":[3767,3767],"./polyhedra/Johnson/Elongated_pentagonal_gyrocupolarotunda.off":[4975,7356],"./polyhedra/Johnson/Elongated_pentagonal_orthobicupola.off":[5581,5581],"./polyhedra/Johnson/Elongated_pentagonal_orthobirotunda.off":[9728,9728],"./polyhedra/Johnson/Elongated_pentagonal_orthocupolarotunda.off":[9583,9583],"./polyhedra/Johnson/Elongated_pentagonal_pyramid.off":[7274,7274],"./polyhedra/Johnson/Elongated_pentagonal_rotunda.off":[4942,4942],"./polyhedra/Johnson/Elongated_square_bipyramid.off":[181,181],"./polyhedra/Johnson/Elongated_square_cupola.off":[6200,6200],"./polyhedra/Johnson/Elongated_square_gyrobicupola.off":[8958,8958],"./polyhedra/Johnson/Elongated_square_pyramid.off":[4752,4752],"./polyhedra/Johnson/Elongated_triangular_bipyramid.off":[8347,8347],"./polyhedra/Johnson/Elongated_triangular_cupola.off":[3906,3906],"./polyhedra/Johnson/Elongated_triangular_gyrobicupola.off":[7176,7176],"./polyhedra/Johnson/Elongated_triangular_orthobicupola.off":[9645,9645],"./polyhedra/Johnson/Elongated_triangular_pyramid.off":[7002,7002],"./polyhedra/Johnson/Gyrate_bidiminished_rhombicosidodecahedron.off":[2792,2792],"./polyhedra/Johnson/Gyrate_rhombicosidodecahedron.off":[4796,4796],"./polyhedra/Johnson/Gyrobifastigium.off":[6299,6299],"./polyhedra/Johnson/Gyroelongated_pentagonal_bicupola.off":[7822,7822],"./polyhedra/Johnson/Gyroelongated_pentagonal_birotunda.off":[3269,3269],"./polyhedra/Johnson/Gyroelongated_pentagonal_cupola.off":[5397,5397],"./polyhedra/Johnson/Gyroelongated_pentagonal_cupolarotunda.off":[1662,1662],"./polyhedra/Johnson/Gyroelongated_pentagonal_pyramid.off":[7283,7283],"./polyhedra/Johnson/Gyroelongated_pentagonal_rotunda.off":[8712,8712],"./polyhedra/Johnson/Gyroelongated_square_bicupola.off":[2100,2100],"./polyhedra/Johnson/Gyroelongated_square_bipyramid.off":[6572,6572],"./polyhedra/Johnson/Gyroelongated_square_cupola.off":[9535,9535],"./polyhedra/Johnson/Gyroelongated_square_pyramid.off":[9365,9365],"./polyhedra/Johnson/Gyroelongated_triangular_bicupola.off":[5634,5634],"./polyhedra/Johnson/Gyroelongated_triangular_cupola.off":[3209,3209],"./polyhedra/Johnson/Hebesphenomegacorona.off":[9399,9399],"./polyhedra/Johnson/Metabiaugmented_dodecahedron.off":[2197,2197],"./polyhedra/Johnson/Metabiaugmented_hexagonal_prism.off":[4526,4526],"./polyhedra/Johnson/Metabiaugmented_truncated_dodecahedron.off":[576,576],"./polyhedra/Johnson/Metabidiminished_icosahedron.off":[7090,7090],"./polyhedra/Johnson/Metabidiminished_rhombicosidodecahedron.off":[7392,7392],"./polyhedra/Johnson/Metabigyrate_rhombicosidodecahedron.off":[3612,3612],"./polyhedra/Johnson/Metagyrate_diminished_rhombicosidodecahedron.off":[30,30],"./polyhedra/Johnson/Parabiaugmented_dodecahedron.off":[3512,3512],"./polyhedra/Johnson/Parabiaugmented_hexagonal_prism.off":[1557,1557],"./polyhedra/Johnson/Parabiaugmented_truncated_dodecahedron.off":[6481,6481],"./polyhedra/Johnson/Parabidiminished_rhombicosidodecahedron.off":[7007,7007],"./polyhedra/Johnson/Parabigyrate_rhombicosidodecahedron.off":[2707,2707],"./polyhedra/Johnson/Paragyrate_diminished_rhombicosidodecahedron.off":[3903,3903],"./polyhedra/Johnson/Pentagonal_bipyramid.off":[1241,1241],"./polyhedra/Johnson/Pentagonal_cupola.off":[92,92],"./polyhedra/Johnson/Pentagonal_gyrobicupola.off":[114,114],"./polyhedra/Johnson/Pentagonal_gyrocupolarotunda.off":[5362,5362],"./polyhedra/Johnson/Pentagonal_orthobicupola.off":[1139,1139],"./polyhedra/Johnson/Pentagonal_orthobirotunda.off":[1694,1694],"./polyhedra/Johnson/Pentagonal_orthocupolarotunda.off":[4857,4857],"./polyhedra/Johnson/Pentagonal_pyramid.off":[4900,4900],"./polyhedra/Johnson/Pentagonal_rotunda.off":[2115,2115],"./polyhedra/Johnson/Snub_disphenoid.off":[9318,9318],"./polyhedra/Johnson/Snub_square_antiprism.off":[630,630],"./polyhedra/Johnson/Sphenocorona.off":[5047,5047],"./polyhedra/Johnson/Sphenomegacorona.off":[6073,6073],"./polyhedra/Johnson/Square_cupola.off":[9834,9834],"./polyhedra/Johnson/Square_gyrobicupola.off":[3328,3328],"./polyhedra/Johnson/Square_orthobicupola.off":[4866,4866],"./polyhedra/Johnson/Square_pyramid.off":[3778,3778],"./polyhedra/Johnson/Triangular_bipyramid.off":[9849,9849],"./polyhedra/Johnson/Triangular_cupola.off":[847,3228],"./polyhedra/Johnson/Triangular_hebesphenorotunda.off":[1926,1926],"./polyhedra/Johnson/Triangular_orthobicupola.off":[4787,4787],"./polyhedra/Johnson/Triaugmented_dodecahedron.off":[2928,2928],"./polyhedra/Johnson/Triaugmented_hexagonal_prism.off":[5645,5645],"./polyhedra/Johnson/Triaugmented_triangular_prism.off":[7155,7155],"./polyhedra/Johnson/Triaugmented_truncated_dodecahedron.off":[5385,5385],"./polyhedra/Johnson/Tridiminished_icosahedron.off":[347,347],"./polyhedra/Johnson/Tridiminished_rhombicosidodecahedron.off":[5287,5287],"./polyhedra/Johnson/Trigyrate_rhombicosidodecahedron.off":[8315,8315],"./polyhedra/KeplerPoinsot/Great_dodecahedron.off":[9464,9464],"./polyhedra/KeplerPoinsot/Great_icosahedron.off":[9431,9431],"./polyhedra/KeplerPoinsot/Great_stellated_dodecahedron.off":[2361,2361],"./polyhedra/KeplerPoinsot/Small_stellated_dodecahedron.off":[2643,2643],"./polyhedra/Platonic/Cube.off":[4404,4404],"./polyhedra/Platonic/Dodecahedron.off":[9425,9425],"./polyhedra/Platonic/Icosahedron.off":[6132,6132],"./polyhedra/Platonic/Octahedron.off":[8724,8724],"./polyhedra/Platonic/Tetrahedron.off":[9035,9035]};function o(e){if(!r.o(n,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],o=t[0];return r.e(t[1]).then((()=>r.t(o,17)))}o.keys=()=>Object.keys(n),o.id=7074,e.exports=o},8676:(e,t,r)=>{"use strict";var n={};r.r(n),r.d(n,{apply4DInverseRotation:()=>J,apply4DMatrix:()=>T,are4DPointsClose:()=>N,arePointsClose:()=>G,calculateCentroid:()=>ee,changeMaterialProperty:()=>q,create4DRotationMat:()=>$,decomposeSelfIntersectingPolygon:()=>k,disposeGroup:()=>W,filterArray:()=>ne,findPlanesIntersection:()=>te,getFarthest4DPointDist:()=>V,getFarthestPointDist:()=>U,getSortedValuesDesc:()=>Z,getUniqueSortedPairs:()=>z,inverseRotatePoint:()=>F,parseJsonFileFromInput:()=>Q,range:()=>H,rotate4DPointsToXY:()=>B,rotateToXY:()=>L,toBufferGeometry:()=>Y,validateCellsSelectorConfig:()=>K,validateRecordConfig:()=>X});var o=r(4922),i=r(9437),a=r(7024),s=r(8735),c=r.n(s),l=r(1291),u=r.n(l),f=r(1112),h=r.n(f),d=r(6898),p=r(6363),y=r(2999),v=r(5109),m=r(1419),g=r(4264),w=r(4385);const b="\nvec3 schlegelProjection(vec4 point4D) {\n  if (isOrtho) return point4D.xyz;\n  return projectionDistance * point4D.xyz / (projectionDistance - point4D.w);\n}\n",x="\nvec3 transformCylinderPoint(vec3 point, vec3 v1, vec3 v2) {\n    // Compute direction and length\n    vec3 d = v2 - v1;\n    float d_length = length(d);\n    \n    vec3 d_ = d;\n    d_.y = 0.0;\n    if (length(d_) < 1e-6) {\n      vec3 scaled_point = point * vec3(1.0, d_length, 1.0);\n      if (v2.y > v1.y) return scaled_point + v1;\n      if (v2.y < v1.y) return scaled_point + v2;\n    }\n    \n    // If v1 and v2 are too close, return v1 (or discard)\n    if (d_length < 1e-6) {\n        return v1; // Or handle as error\n    }\n    vec3 d_normalized = d / d_length;\n\n    // Step 1: Scale along y-axis\n    vec3 scaled_point = point * vec3(1.0, d_length, 1.0);\n\n    // Step 2: Rotate y-axis to d_normalized\n    vec3 y_axis = vec3(0.0, 1.0, 0.0);\n    float dot_product = dot(y_axis, d_normalized);\n    \n    // Handle parallel cases (dot_product ≈ ±1)\n    if (abs(dot_product) > 0.99999) {\n        if (dot_product < 0.0) {\n            // Opposite direction: rotate 180° around x-axis\n            scaled_point.y = -scaled_point.y; // Equivalent to 180° rotation\n        }\n        // Else: same direction, no rotation needed\n    } else {\n        // General case: compute rotation axis and angle\n        vec3 rotation_axis = normalize(cross(d_normalized, y_axis));\n        float rotation_angle = acos(clamp(dot_product, -1.0, 1.0));\n        \n        // Rodrigues' rotation formula\n        float cos_angle = cos(rotation_angle);\n        float sin_angle = sin(rotation_angle);\n        \n        mat3 K = mat3(\n            0.0, -rotation_axis.z, rotation_axis.y,\n            rotation_axis.z, 0.0, -rotation_axis.x,\n            -rotation_axis.y, rotation_axis.x, 0.0\n        );\n        mat3 R = mat3(1.0) + sin_angle * K + (1.0 - cos_angle) * (K * K);\n        scaled_point = R * scaled_point;\n    }\n\n    // Step 3: Translate to v1\n    return scaled_point + v1;\n}\n";const S={sphereMaterial3D:function(e,t,r,n){return(e=e.clone()).onBeforeCompile=function(e){e.uniforms.radius=t,e.uniforms.rotation4D=r,e.uniforms.offset3D=n,e.vertexShader="\n      attribute vec3 pos;\n      uniform float radius;\n      uniform mat4 rotation4D;\n      uniform vec3 offset3D;\n      ".concat(e.vertexShader,"\n    "),e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","\n      #include <begin_vertex>\n      // 顶点按 radius 统一缩放\n      transformed *= radius;\n      transformed += (rotation4D * vec4(pos, 0)).xyz;\n      transformed += offset3D;\n      ")},e},cylinderMaterial3D:function(e,t,r,n){return(e=e.clone()).onBeforeCompile=function(e){e.uniforms.radius=t,e.uniforms.rotation4D=r,e.uniforms.offset3D=n,e.vertexShader="\n      attribute vec3 v1;\n      attribute vec3 v2;\n      uniform float radius;\n      uniform mat4 rotation4D;\n      uniform vec3 offset3D;\n      ".concat(x,"\n      ").concat(e.vertexShader,"\n    "),e.vertexShader=e.vertexShader.replace("#include <defaultnormal_vertex>","\n      #include <defaultnormal_vertex>\n      // 计算法向量。\n      vec3 transformedV1 = (rotation4D * vec4(v1, 0)).xyz;\n      vec3 transformedV2 = (rotation4D * vec4(v2, 0)).xyz;\n      \n      objectNormal = transformCylinderPoint(objectNormal, transformedV1, transformedV2);\n      transformedNormal = normalMatrix * objectNormal;\n      ").replace("#include <begin_vertex>","\n      #include <begin_vertex>\n      // 让圆柱变粗/细。\n      transformed.x *= radius;\n      transformed.z *= radius;\n      transformed.y += 0.5;\n      transformed = transformCylinderPoint(transformed, transformedV1, transformedV2);\n      transformed += offset3D;\n      ")},e},faceMaterial3D:function(e,t,r){return(e=e.clone()).onBeforeCompile=function(e){e.uniforms.rotation4D=t,e.uniforms.offset3D=r,e.vertexShader="\n      uniform mat4 rotation4D;\n      uniform vec3 offset3D;\n      ".concat(e.vertexShader,"\n    "),e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","\n      #include <begin_vertex>\n      // 将位置旋转。\n      transformed = (rotation4D * vec4(transformed, 0)).xyz;\n      transformed += offset3D;\n      ")},e},sphereMaterial:function(e,t,r,n,o,i,a){return(e=e.clone()).onBeforeCompile=function(e){e.uniforms.projectionDistance=i,e.uniforms.rotation4D=r,e.uniforms.offset4D=n,e.uniforms.offset3D=o,e.uniforms.radius=t,e.uniforms.isOrtho=a,e.vertexShader="\n      attribute vec4 center4D;\n      uniform float radius;\n      uniform float projectionDistance;\n      uniform bool isOrtho;\n      uniform mat4 rotation4D;\n      uniform vec4 offset4D;\n      uniform vec3 offset3D;\n\n      ".concat(b,"\n      ").concat(e.vertexShader,"\n    "),e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","\n      #include <begin_vertex>\n      // 将顶点按球体半径缩放，再加上中心点的 3D 投影\n      vec3 center3D = schlegelProjection(rotation4D * center4D + offset4D);\n      transformed = transformed * radius + center3D + offset3D;\n      ")},e},cylinderMaterial:function(e,t,r,n,o,i,a){return(e=e.clone()).onBeforeCompile=function(e){e.uniforms.projectionDistance=i,e.uniforms.rotation4D=r,e.uniforms.offset4D=n,e.uniforms.offset3D=o,e.uniforms.radius=t,e.uniforms.isOrtho=a,e.vertexShader="\n      attribute vec4 v1;\n      attribute vec4 v2;\n      uniform float radius;\n      uniform float projectionDistance;\n      uniform bool isOrtho;\n      uniform mat4 rotation4D;\n      uniform vec4 offset4D;\n      uniform vec3 offset3D;\n      \n      ".concat(b,"\n      ").concat(x,"\n      ").concat(e.vertexShader,"\n    "),e.vertexShader=e.vertexShader.replace("#include <defaultnormal_vertex>","\n      #include <defaultnormal_vertex>\n      // 计算 4D 空间中圆柱两端点的投影\n      vec3 pv1 = schlegelProjection(rotation4D * v1 + offset4D);\n      vec3 pv2 = schlegelProjection(rotation4D * v2 + offset4D);\n      // 计算法向量\n      objectNormal = transformCylinderPoint(objectNormal, pv1, pv2);\n      transformedNormal = normalMatrix * objectNormal;\n      ").replace("#include <begin_vertex>","\n      #include <begin_vertex>\n      // 将模型顶点在 x, z 方向缩放至所需半径（让圆柱变粗/细）\n      transformed.x *= radius;\n      transformed.z *= radius;\n      transformed.y += 0.5;\n      // 将顶点旋转平移到合适位置\n      transformed = transformCylinderPoint(transformed, pv1, pv2) + offset3D;\n      ")},e},faceMaterial:function(e,t,r,n,o,i){return(e=e.clone()).onBeforeCompile=function(e){e.uniforms.projectionDistance=o,e.uniforms.rotation4D=t,e.uniforms.offset4D=r,e.uniforms.offset3D=n,e.uniforms.isOrtho=i,e.vertexShader="\n      attribute vec4 position4D;\n      uniform float projectionDistance;\n      uniform bool isOrtho;\n      uniform mat4 rotation4D;\n      uniform vec4 offset4D;\n      uniform vec3 offset3D;\n      \n      ".concat(b,"\n      ").concat(e.vertexShader,"\n    "),e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","\n      #include <begin_vertex>\n      // 将四维位置旋转后投影到三维空间\n      vec4 rotatedPosition4D = rotation4D * position4D + offset4D;\n      transformed = schlegelProjection(rotatedPosition4D) + offset3D;\n      ")},e},axisMaterial:function(e,t,r,n,o){return(e=e.clone()).onBeforeCompile=function(e){e.uniforms.rotation4D=t,e.uniforms.offset4D=r,e.uniforms.offset3D=n,e.uniforms.offsetScale=o,e.vertexShader="\n      attribute uint axis;\n      attribute float len;\n      uniform mat4 rotation4D;\n      uniform vec4 offset4D;\n      uniform vec3 offset3D;\n      uniform float offsetScale;\n      \n      ".concat(x,"\n      ").concat(e.vertexShader,"\n    "),e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","\n      #include <begin_vertex>\n      // 根据 axis 决定投影到四维哪条轴上\n      vec4 v = vec4(0.0);\n      if (axis == 0u) v.x = 1.0;\n      else if (axis == 1u) v.y = 1.0;\n      else if (axis == 2u) v.z = 1.0;\n      else if (axis == 3u) v.w = 1.0;\n      // 投影并计算缩放，使圆柱长度符合 len\n      vec3 vProj = (rotation4D * v).xyz;\n      float s = length(vProj) / length(v);\n      float scale = len / length(vProj) * s;\n      vProj *= scale;\n      // 旋转与平移\n      transformed = transformCylinderPoint(position + vec3(0.0, 0.5, 0.0), -vProj + offset4D.xyz * offsetScale, vProj + offset4D.xyz * offsetScale) + offset3D * offsetScale;\n      ")},e},axisConeMaterial:function(e,t,r,n,o){return(e=e.clone()).onBeforeCompile=function(e){e.uniforms.rotation4D=t,e.uniforms.offset4D=r,e.uniforms.offset3D=n,e.uniforms.offsetScale=o,e.vertexShader="\n      attribute uint axis;\n      attribute float len;\n      attribute float height;\n      uniform mat4 rotation4D;\n      uniform vec4 offset4D;\n      uniform vec3 offset3D;\n      uniform float offsetScale;\n\n      ".concat(x,"\n      ").concat(e.vertexShader,"\n    "),e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","\n      #include <begin_vertex>\n      // 同 axisMaterial，但是底部坐标变成了坐标轴圆柱的结束坐标。\n      vec4 v = vec4(0.0);\n      if (axis == 0u) v.x = 1.0;\n      else if (axis == 1u) v.y = 1.0;\n      else if (axis == 2u) v.z = 1.0;\n      else if (axis == 3u) v.w = 1.0;\n      vec3 vProj = (rotation4D * v).xyz;\n      float s = length(vProj) / length(v);\n      float scale1 = len / length(vProj) * s;\n      float scale2 = (len * s + height) / length(vProj);\n      vec3 vProj1 = vProj * scale1;\n      vec3 vProj2 = vProj * scale2;\n      transformed = transformCylinderPoint(position + vec3(0.0, 0.5, 0.0), vProj1 + offset4D.xyz * offsetScale, vProj2 + offset4D.xyz * offsetScale) + offset3D * offsetScale;\n      ")},e},axisLabelMaterial:function(e,t,r,n,o){return(e=e.clone()).onBeforeCompile=function(e){e.uniforms.rotation4D=t,e.uniforms.offset4D=r,e.uniforms.offset3D=n,e.uniforms.offsetScale=o,e.vertexShader="\n      attribute uint axis;\n      attribute float len;\n      attribute float offset;\n      uniform mat4 rotation4D;\n      uniform vec4 offset4D;\n      uniform vec3 offset3D;\n      uniform float offsetScale;\n\n      ".concat(x,"\n      ").concat(e.vertexShader,"\n    "),e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","\n      #include <begin_vertex>\n      // 类似 axisCone，但是往坐标轴方向上偏移了一些。\n      vec4 v = vec4(0.0);\n      if (axis == 0u) v.x = 1.0;\n      else if (axis == 1u) v.y = 1.0;\n      else if (axis == 2u) v.z = 1.0;\n      else if (axis == 3u) v.w = 1.0;\n      vec3 vProj = (rotation4D * v).xyz;\n      float s = length(vProj) / length(v);\n      float scale1 = (len * s + offset) / length(vProj);\n      float scale2 = (len * s + offset + 1.0) / length(vProj);\n      vec3 vProj1 = vProj * scale1;\n      vec3 vProj2 = vProj * scale2;\n      transformed = transformCylinderPoint(position + vec3(0.0, 0.5, 0.0), vProj1 + offset4D.xyz * offsetScale, vProj2 + offset4D.xyz * offsetScale) + offset3D * offsetScale;\n      ")},e}};var _=r(2543),E=r(2312),O=r(9004);function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=P(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==P(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C(e){return function(e){if(Array.isArray(e))return I(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||R(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||R(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=R(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function R(e,t){if(e){if("string"==typeof e)return I(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?I(e,t):void 0}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function k(e){var t=e.map((function(e){return[+e.x.toFixed(6),+e.y.toFixed(6)]}));t.length>0&&t.push([t[0][0],t[0][1]]);var r,n=[],o=A(O.union([t]));try{for(o.s();!(r=o.n()).done;){var i,a=A(r.value);try{for(a.s();!(i=a.n()).done;){var s=i.value;if(0!==s.length){var c=s.slice(0,-1).map((function(e){var t=M(e,2),r=t[0],n=t[1];return new E.Point(r,n)}));n.push(c)}}}catch(e){a.e(e)}finally{a.f()}}}catch(e){o.e(e)}finally{o.f()}return n}function F(e,t,r){var n=Math.cos(-t),o=Math.sin(-t),i=Math.cos(-r),a=Math.sin(-r),s=e.x*i+e.z*a,c=-e.x*a+e.z*i;return{x:s,y:e.y*n-c*o,z:e.y*o+c*n}}function L(e){var t=function(e){var t=e[1].x-e[0].x,r=e[1].y-e[0].y,n=e[1].z-e[0].z,o=e[2].x-e[0].x,i=e[2].y-e[0].y,a=e[2].z-e[0].z,s=r*a-n*i,c=n*o-t*a,l=t*i-r*o,u=Math.sqrt(s**2+c**2+l**2);return{x:s/u,y:c/u,z:l/u}}(e),r=Math.atan2(t.y,t.z),n=Math.atan2(-t.x,Math.sqrt(t.y**2+t.z**2)),o=e.map((function(e){return function(e,t,r){var n=Math.cos(t),o=Math.sin(t),i=Math.cos(r),a=Math.sin(r),s=e.y*n-e.z*o,c=e.y*o+e.z*n;return{x:e.x*i+c*a,y:s,z:-e.x*a+c*i,orig:e}}(e,r,n)}));return{rotated:o,theta:r,phi:n,z:o[0].z}}function G(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.EPSILON,n=Math.abs(e.x-t.x),o=Math.abs(e.y-t.y),i=Math.abs(e.z-t.z);return n<=r&&o<=r&&i<=r}function z(e){var t=e.flatMap((function(e){return e.map((function(t,r){return[Math.min(t,e[(r+1)%e.length]),Math.max(t,e[(r+1)%e.length])]}))}));return C(new Set(t.map(JSON.stringify))).map(JSON.parse)}function B(e){var t=e[0],r=e[1],n=e[2],o=[r.x-t.x,r.y-t.y,r.z-t.z,r.w-t.w],i=[n.x-t.x,n.y-t.y,n.z-t.z,n.w-t.w],a=Math.sqrt(o.reduce((function(e,t){return e+t*t}),0));if(a<1e-10)throw new Error("Vector u is too small.");var s=o.map((function(e){return e/a})),c=i.reduce((function(e,t,r){return e+t*o[r]}),0),l=o.map((function(e){return c/(a*a)*e})),u=i.map((function(e,t){return e-l[t]})),f=Math.sqrt(u.reduce((function(e,t){return e+t*t}),0));if(f<1e-10)throw new Error("Vectors are linearly dependent.");for(var h=u.map((function(e){return e/f})),d=[s,h],p=[],y=function(){for(var e=C(m[v]),t=function(){var t=n[r],o=e.reduce((function(e,r,n){return e+r*t[n]}),0);e=e.map((function(e,r){return e-o*t[r]}))},r=0,n=d;r<n.length;r++)t();var o=Math.sqrt(e.reduce((function(e,t){return e+t*t}),0));if(o>1e-6&&(p.push(e.map((function(e){return e/o}))),d.push(e.map((function(e){return e/o}))),p.length>=2))return 1},v=0,m=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];v<m.length&&!y();v++);if(p.length<2)throw new Error("Failed to find orthogonal basis");var g=[s,h,p[0],p[1]],w=e.map((function(e){return T(e,g)})),b=w[0];return{rotated:w,rotationMatrix:g,z:b.z,w:b.w}}function T(e,t){var r=[e.x,e.y,e.z,e.w],n=[t[0][0]*r[0]+t[0][1]*r[1]+t[0][2]*r[2]+t[0][3]*r[3],t[1][0]*r[0]+t[1][1]*r[1]+t[1][2]*r[2]+t[1][3]*r[3],t[2][0]*r[0]+t[2][1]*r[1]+t[2][2]*r[2]+t[2][3]*r[3],t[3][0]*r[0]+t[3][1]*r[1]+t[3][2]*r[2]+t[3][3]*r[3]];return{x:n[0],y:n[1],z:n[2],w:n[3]}}function J(e,t){return T(e,[[t[0][0],t[1][0],t[2][0],t[3][0]],[t[0][1],t[1][1],t[2][1],t[3][1]],[t[0][2],t[1][2],t[2][2],t[3][2]],[t[0][3],t[1][3],t[2][3],t[3][3]]])}function N(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.EPSILON,n=Math.abs(e.x-t.x),o=Math.abs(e.y-t.y),i=Math.abs(e.z-t.z),a=Math.abs(e.w-t.w);return n<=r&&o<=r&&i<=r&&a<=r}function H(e,t){var r=Math.max(t-e+1,0);return Array.from({length:r},(function(t,r){return e+r}))}function U(e){var t;return t=e.reduce((function(e,t){var r=t.x**2+t.y**2+t.z**2;return r>(e.dist||-1)?{point:t,dist:r}:e}),{}).point,Math.sqrt(t.x**2+t.y**2+t.z**2)}function V(e){var t;return t=e.reduce((function(e,t){var r=t.x**2+t.y**2+t.z**2+t.w**2;return r>(e.dist||-1)?{point:t,dist:r}:e}),{}).point,Math.sqrt(t.x**2+t.y**2+t.z**2+t.w**2)}function q(e,t,r){e&&e.traverse((function(e){if(e.isMesh&&e.material)if(Array.isArray(e.material)){var n,o=A(e.material);try{for(o.s();!(n=o.n()).done;){var i=n.value;(0,_.set)(i,t,r),i.needsUpdate=!0}}catch(e){o.e(e)}finally{o.f()}}else(0,_.set)(e.material,t,r),e.material.needsUpdate=!0}))}function W(e){e.traverse((function(e){var t,r;e.isMesh&&(null===(t=e.geometry)||void 0===t||t.dispose(),null===(r=e.material)||void 0===r||r.dispose())})),e.clear()}function Y(e){var t=new o.LoY;return["position","normal","uv"].forEach((function(r){return e.attributes[r]&&t.setAttribute(r,e.attributes[r].clone())})),e.index&&t.setIndex(e.index.clone()),e.parameters&&(t.parameters=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e.parameters)),e.dispose(),t}function $(e,t,r,n,i,a){var s=o.cj9.degToRad(e),c=o.cj9.degToRad(t),l=o.cj9.degToRad(r),u=o.cj9.degToRad(n),f=o.cj9.degToRad(i),h=o.cj9.degToRad(a),d=Math.cos(s),p=Math.sin(s),y=Math.cos(c),v=Math.sin(c),m=Math.cos(l),g=Math.sin(l),w=Math.cos(u),b=Math.sin(u),x=Math.cos(f),S=Math.sin(f),_=Math.cos(h),E=Math.sin(h),O=(new o.kn4).set(d,-p,0,0,p,d,0,0,0,0,1,0,0,0,0,1),P=(new o.kn4).set(y,0,-v,0,0,1,0,0,v,0,y,0,0,0,0,1),j=(new o.kn4).set(m,0,0,-g,0,1,0,0,0,0,1,0,g,0,0,m),D=(new o.kn4).set(1,0,0,0,0,w,-b,0,0,b,w,0,0,0,0,1),C=(new o.kn4).set(1,0,0,0,0,x,0,-S,0,0,1,0,0,S,0,x),M=(new o.kn4).set(1,0,0,0,0,1,0,0,0,0,_,-E,0,0,E,_),A=new o.kn4;return A.multiply(M),A.multiply(C),A.multiply(D),A.multiply(j),A.multiply(P),A.multiply(O),A}function Z(e){return Object.entries(e).sort((function(e,t){var r=M(e,1)[0];return+M(t,1)[0]-+r})).map((function(e){return M(e,2)[1]}))}function X(e,t){if(void 0!==e.initialRot){if(!Array.isArray(e.initialRot)||6!==e.initialRot.length||e.initialRot.some((function(e){return"number"!=typeof e})))throw new Error("initialRot 字段必须是包含 6 个实数的数组。");if((0!==e.initialRot[2]||0!==e.initialRot[4]||0!==e.initialRot[5])&&!t)throw new Error("initialRot 字段的索引 2、4、5 上的值在非 4D 模式下必须为 0。")}if(void 0!==e.initialOfs){if(!t)throw new Error("initialOfs 字段的只在 4D 模式下可用。");if(!Array.isArray(e.initialOfs)||4!==e.initialOfs.length||e.initialOfs.some((function(e){return"number"!=typeof e})))throw new Error("initialOfs 字段必须是包含 4 个实数的数组。")}if(void 0!==e.initialOfs3&&(!Array.isArray(e.initialOfs3)||3!==e.initialOfs3.length||e.initialOfs3.some((function(e){return"number"!=typeof e}))))throw new Error("initialOfs3 字段必须是包含 3 个实数的数组。");if(void 0!==e.initialVerticesEdgesDim&&("number"!=typeof e.initialVerticesEdgesDim||e.initialVerticesEdgesDim<=0))throw new Error("initialVerticesEdgesDim 字段必须是正实数。");if(void 0!==e.initialProjDist){if(!t)throw new Error("initialProjDist 字段的只在 4D 模式下可用。");if("number"!=typeof e.initialProjDist||e.initialProjDist<=0)throw new Error("initialProjDist 字段必须是正实数。")}if(void 0!==e.initialFaceOpacity&&("number"!=typeof e.initialFaceOpacity||e.initialFaceOpacity<0||e.initialFaceOpacity>1))throw new Error("initialFaceOpacity 字段必须是 0~1 之间的实数。");if(void 0!==e.initialVisibilities)for(var r=["faces","wireframe","vertices","axes"],n=0,o=Object.entries(e.initialVisibilities);n<o.length;n++){var i=M(o[n],2),a=i[0],s=i[1];if(!r.includes(a))throw new Error("initialVisibilities 字段包含无效的目标类型: ".concat(a,"。"));if("boolean"!=typeof s)throw new Error("initialVisibilities.".concat(a," 字段必须为布尔值。"))}if(void 0!==e.initialCameraProjMethod&&!["persp","ortho"].includes(e.initialCameraProjMethod))throw new Error('initialCameraProjMethod 字段必须为 "persp" 或 "ortho"。');if(void 0!==e.initialSchleProjEnable){if(!t)throw new Error("initialSchleProjEnable 字段的只在 4D 模式下可用。");if("boolean"!=typeof e.initialSchleProjEnable)throw new Error("initialSchleProjEnable 字段必须为布尔值。")}if(void 0!==e.initialHighlightConfig){if(!t)throw new Error("initialHighlightConfig 字段的只在 4D 模式下可用。");for(var c=0,l=Object.entries(e.initialHighlightConfig);c<l.length;c++){var u=M(l[c],2),f=u[0],h=u[1];if(!/^(0x)?[0-9a-fA-F]{8}$/.test(f))throw new Error("initialHighlightConfig 的十六进制 RGBA 色码 ".concat(f," 无效。"));K(h,"initialHighlightConfig.".concat(f,"."))}}if(!Array.isArray(e.actions)||e.actions.some((function(e){return!(e instanceof Object)})))throw new Error("action 字段必须为对象列表。");e.actions.forEach((function(e,r){switch(e.type){case"rot":if("number"!=typeof e.angle)throw new Error("actions[".concat(r,"] 操作的 angle 字段必须为实数。"));if(!(Number.isInteger(e.plane)&&0<=e.plane&&e.plane<=5))throw new Error("actions[".concat(r,"] 操作的 plane 字段必须为大于等于零小于六的整数。"));if(!t&&[2,4,5].includes(e.plane))throw new Error("actions[".concat(r,"] 操作的 plane 字段值 ").concat(e.plane," 只在四维模式可用。"));break;case"trans4":if(!t)throw new Error("actions[".concat(r,"] 操作只在四维模式可用。"));if(4!==e.ofs.length||e.ofs.some((function(e){return"number"!=typeof e})))throw new Error("actions[".concat(r,"] 操作的 ofs 字段必须为四个实数的数组。"));break;case"trans3":if(3!==e.ofs.length||e.ofs.some((function(e){return"number"!=typeof e})))throw new Error("actions[".concat(r,"] 操作的 ofs 字段必须为三个实数的数组。"));break;case"setVerticesEdgesDim":if("number"!=typeof e.dimOfs)throw new Error("actions[".concat(r,"] 操作的 dimOfs 字段必须为实数。"));break;case"setProjDist":if(!t)throw new Error("actions[".concat(r,"] 操作只在四维模式可用。"));if("number"!=typeof e.projDistOfs)throw new Error("actions[".concat(r,"] 操作的 projDistOfs 字段必须为实数。"));break;case"setFaceOpacity":if("number"!=typeof e.faceOpacityOfs)throw new Error("actions[".concat(r,"] 操作的 faceOpacityOfs 字段必须为实数。"));break;case"setVisibility":if(!["faces","wireframe","vertices","axes"].includes(e.target))throw new Error("actions[".concat(r,"] 操作的 target 字段值必须为 faces、wireframe、vertices 或 axes 中的一者。"));if("boolean"!=typeof e.visibility)throw new Error("actions[".concat(r,"] 操作的 visibility 字段值必须为 boolean 类型。"));break;case"setCameraProjMethod":if("persp"!==e.projMethod&&"ortho"!==e.projMethod)throw new Error("actions[".concat(r,"] 操作的 projMethod 字段值必须为 persp 或 ortho 中的一者。"));break;case"setSchleProjEnable":if(!t)throw new Error("actions[".concat(r,"] 操作只在四维模式可用。"));if("boolean"!=typeof e.enable)throw new Error("actions[".concat(r,"] 操作的 enable 字段值必须为 boolean 类型。"));break;case"highlightCells":if(!t)throw new Error("actions[".concat(r,"] 操作只在四维模式可用。"));for(var n=0,o=Object.entries(e.highlightConfig);n<o.length;n++){var i=M(o[n],2),a=i[0],s=i[1];if(!/^(0x)?[0-9a-fA-F]{8}$/.test(a))throw new Error("actions[".concat(r,"].highlightConfig 的十六进制 RGBA 色码 ").concat(a," 无效。"));K(s,"actions[".concat(r,"].highlightConfig.").concat(a,"."))}break;default:throw new Error("actions[".concat(r,"] 操作的类型 ").concat(e.type," 无效。"))}if(Object.hasOwnProperty.call(e,"start")&&Object.hasOwnProperty.call(e,"end")&&Object.hasOwnProperty.call(e,"at"))throw new Error("actions[".concat(r,"] 要么同时拥有 start 和 end 字段，要么只拥有 at 字段。"));if(Object.hasOwnProperty.call(e,"start")&&Object.hasOwnProperty.call(e,"end")){if(["setVisibility","setCameraProjMethod","setSchleProjEnable","highlightCells"].includes(e.type))throw new Error("actions[".concat(r,"] 的 start 和 end 字段值只适用于以下类型的操作：rot、trans4、trans3、setVerticesEdgesDim、setProjDist、setFaceOpacity。"));if(!Number.isInteger(e.start)||!Number.isInteger(e.end)||e.end<e.start||e.start<0||e.end<0)throw new Error("actions[".concat(r,"] 的 start 和 end 字段必须均为大于等于 0 的整数，且 end 大于等于 start。"))}else{if(!Object.hasOwnProperty.call(e,"at"))throw new Error("actions[".concat(r,"] 要么同时拥有 start 和 end 字段，要么只拥有 at 字段。"));if(!["setVisibility","setCameraProjMethod","setSchleProjEnable","highlightCells"].includes(e.type))throw new Error("actions[".concat(r,"] 的 at 字段值只适用于以下类型的操作：setVisibility、setCameraProjMethod、setSchleProjEnable、highlightCells。"));if(!Number.isInteger(e.at)||e.at<0)throw new Error("actions[".concat(r,"] 的 at 字段必须为大于等于 0 的整数。"))}}))}function K(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if("all"!==e){if(!e||"object"!==P(e)||Array.isArray(e))throw new Error('highlightConfig 必须是非数组的对象类型或为字符串 "all"。');if(!["indices","ranges","nHedra"].some((function(t){return void 0!==e[t]&&(Array.isArray(e[t])||"object"===P(e[t])&&!Array.isArray(e[t]))}))&&!e.exclude)throw new Error("highlightConfig 必须包含至少一个有效配置项（indices/ranges/nHedra）或 exclude 配置。");var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(void 0!==e.indices){if(!Array.isArray(e.indices))throw new Error("".concat(t,"indices 必须是数组类型。"));e.indices.forEach((function(e,r){if(!Number.isInteger(e)||e<0)throw new Error("".concat(t,"indices[").concat(r,"] 必须是非负整数，当前值为 ").concat(e,"。"))}))}if(void 0!==e.ranges){if(!Array.isArray(e.ranges))throw new Error("".concat(t,"ranges 必须是二维数组类型。"));e.ranges.forEach((function(e,r){if(!Array.isArray(e)||2!==e.length)throw new Error("".concat(t,"ranges[").concat(r,"] 必须是 [start, end] 格式的数组。"));var n=M(e,2),o=n[0],i=n[1];if(!Number.isInteger(o)||o<0)throw new Error("".concat(t,"ranges[").concat(r,"][0]（start）必须是非负整数，当前值为 ").concat(o,"。"));if(!Number.isInteger(i)||i<0)throw new Error("".concat(t,"ranges[").concat(r,"][1]（end）必须是非负整数，当前值为 ").concat(i,"。"));if(o>i)throw new Error("".concat(t,"ranges[").concat(r,"] 的 start 值 ").concat(o," 不能大于 end 值 ").concat(i,"。"))}))}if(void 0!==e.nHedra){if(!Array.isArray(e.nHedra))throw new Error("".concat(t,"nHedra 必须是数组类型。"));e.nHedra.forEach((function(e,n){if("number"==typeof e){if(!Number.isInteger(e)||e<=0)throw new Error("".concat(t,"nHedra[").concat(n,"] 作为数字时必须为正整数，当前值为 ").concat(e,"。"))}else{if("object"!==P(e)||null===e)throw new Error("".concat(t,"nHedra[").concat(n,"] 必须是数字或配置对象。"));if(!Number.isInteger(e.nFaces)||e.nFaces<=0)throw new Error("".concat(t,"nHedra[").concat(n,"].nFaces 必须为正整数，当前值为 ").concat(e.nFaces,"。"));if(!e.ranges)throw new Error("".concat(t,"nHedra[").concat(n,"].ranges 是必填项。"));if(!Array.isArray(e.ranges))throw new Error("".concat(t,"nHedra[").concat(n,"].ranges 必须是二维数组类型。"));r({ranges:e.ranges},"".concat(t,"nHedra[").concat(n,"]."))}}))}};if(r(e,t),e.exclude){if("object"!==P(e.exclude)||Array.isArray(e.exclude))throw new Error("exclude 配置必须是对象类型。");r(e.exclude,t+"exclude.")}}}function Q(e){return new Promise((function(t,r){"file"===e.type?(e.addEventListener("change",(function n(){if(e.removeEventListener("change",n),e.files&&0!==e.files.length){var o=e.files[0],i=new FileReader;i.onload=function(e){try{var n=JSON.parse(e.target.result);t(n)}catch(e){r(new Error("文件解析失败: "+e.message))}},i.onerror=function(){r(new Error("文件读取失败。"))},i.readAsText(o)}else r(new Error("没有选择文件。"))})),e.click()):r(new Error("提供的元素不是文件输入类型。"))}))}function ee(e){var t,r=0,n=0,o=0,i=e.length,a=A(e);try{for(a.s();!(t=a.n()).done;){var s=t.value;r+=s.x,n+=s.y,o+=s.z}}catch(e){a.e(e)}finally{a.f()}return{x:r/i,y:n/i,z:o/i}}function te(e){var t,r=[],n=A(e);try{for(n.s();!(t=n.n()).done;){var o=re(t.value);if(!o)return null;r.push(o)}}catch(e){n.e(e)}finally{n.f()}return function(e,t,r){var n=e.A,o=e.B,i=e.C,a=e.D,s=t.A,c=t.B,l=t.C,u=t.D,f=r.A,h=r.B,d=r.C,p=r.D,y=n*(c*d-h*l)-o*(s*d-f*l)+i*(s*h-f*c);if(Math.abs(y)<1e-10)return null;return{x:(a*(c*d-h*l)-o*(u*d-p*l)+i*(u*h-p*c))/y,y:(n*(u*d-p*l)-a*(s*d-f*l)+i*(s*p-f*u))/y,z:(n*(c*p-h*u)-o*(s*p-f*u)+a*(s*h-f*c))/y}}(r[0],r[1],r[2])}function re(e){var t=M(e,3),r=t[0],n=t[1],o=t[2],i=n.x-r.x,a=n.y-r.y,s=n.z-r.z,c=o.x-r.x,l=o.y-r.y,u=o.z-r.z,f=a*u-s*l,h=s*c-i*u,d=i*l-a*c;return 0===f&&0===h&&0===d?null:{A:f,B:h,C:d,D:f*r.x+h*r.y+d*r.z}}function ne(e,t){for(var r=new Set(t),n=e.length-1;n>=0;n--)r.has(e[n])&&e.splice(n,1);return e}const oe=r.p+"assets/Sarasa_Mono_SC_Bold.typeface.json";function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}function ae(){ae=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof m?t:m,a=Object.create(i.prototype),s=new M(n||[]);return o(a,"_invoke",{value:P(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var h="suspendedStart",d="suspendedYield",p="executing",y="completed",v={};function m(){}function g(){}function w(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,S=x&&x(x(A([])));S&&S!==r&&n.call(S,a)&&(b=S);var _=w.prototype=m.prototype=Object.create(b);function E(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,i,a,s){var c=f(e[o],e,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==ie(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function P(t,r,n){var o=h;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=j(s,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var l=f(t,r,n);if("normal"===l.type){if(o=n.done?y:d,l.arg===v)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=y,n.method="throw",n.arg=l.arg)}}}function j(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,j(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function D(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(D,this),this.reset(!0)}function A(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(ie(t)+" is not iterable")}return g.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:g,configurable:!0}),g.displayName=l(w,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,l(e,c,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},E(O.prototype),l(O.prototype,s,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new O(u(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},E(_),l(_,c,"Generator"),l(_,a,(function(){return this})),l(_,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=A,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:A(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function se(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function ce(e){return new o._4j({color:e,roughness:.3,metalness:0,flatShading:!0})}function le(e){return new Promise((function(t,r){(new g.J).load(e,(function(e){return t(e)}),void 0,(function(e){return r(e)}))}))}function ue(e,t,r,n,i,a){for(var s=Y(new o.Ho_(.5,.5,1,10)),c=s.attributes.position.count,l=new Uint32Array(c),u=new Float32Array(c),f=0;f<c;f++)l[f]=e,u[f]=50;s.setAttribute("axis",new o.MW4(l,1)),s.setAttribute("len",new o.qtW(u,1));var h=ce(t);return h=S.axisMaterial(h,r,n,i,a),new o.eaF(s,h)}function fe(e,t,r,n,i,a){for(var s=Y(new o.qFE(2,1,10)),c=s.attributes.position.count,l=new Uint32Array(c),u=new Float32Array(c),f=new Float32Array(c),h=0;h<c;h++)l[h]=e,u[h]=50,f[h]=6;s.setAttribute("axis",new o.MW4(l,1)),s.setAttribute("len",new o.qtW(u,1)),s.setAttribute("height",new o.qtW(f,1));var d=ce(t);return d=S.axisConeMaterial(d,r,n,i,a),new o.eaF(s,d)}function he(e,t,r,n,i,a,s,c){var l=Y(new w._(r,{font:n,size:5,depth:1,curveSegments:12}));l.computeBoundingBox(),l.center();for(var u=l.attributes.position.count,f=new Uint32Array(u),h=new Float32Array(u),d=new Float32Array(u),p=0;p<u;p++)f[p]=e,h[p]=50,d[p]=13;l.setAttribute("axis",new o.MW4(f,1)),l.setAttribute("len",new o.qtW(h,1)),l.setAttribute("offset",new o.qtW(d,1));var y=ce(t);return y=S.axisLabelMaterial(y,i,a,s,c),new o.eaF(l,y)}function de(){var e;return e=ae().mark((function e(t,r,n,i,a){var s,c,l,u,f,h,d,p,y,v,m,g,w,b;return ae().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le(oe);case 2:return s=e.sent,c=new o.YJl,l=ue(0,16711680,r,n,i,a),u=fe(0,16711680,r,n,i,a),f=he(0,16711680,"X",s,r,n,i,a),h=ue(1,65280,r,n,i,a),d=fe(1,65280,r,n,i,a),p=he(1,65280,"Y",s,r,n,i,a),y=ue(2,255,r,n,i,a),v=fe(2,255,r,n,i,a),m=he(2,255,"Z",s,r,n,i,a),g=ue(3,15757350,r,n,i,a),w=fe(3,15757350,r,n,i,a),b=he(3,15757350,"W",s,r,n,i,a),c.add(l,u,f),c.add(h,d,p),c.add(y,v,m),c.add(g,w,b),t.add(c),e.abrupt("return",c);case 22:case"end":return e.stop()}}),e)})),de=function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){se(i,n,o,a,s,"next",e)}function s(e){se(i,n,o,a,s,"throw",e)}a(void 0)}))},de.apply(this,arguments)}const pe=function(e,t,r,n,o){return de.apply(this,arguments)};var ye=r(5565),ve=r.n(ye);function me(e){return me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},me(e)}function ge(e){return function(e){if(Array.isArray(e))return xe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||be(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function we(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=be(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function be(e,t){if(e){if("string"==typeof e)return xe(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xe(e,t):void 0}}function xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Se(){Se=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof m?t:m,a=Object.create(i.prototype),s=new M(n||[]);return o(a,"_invoke",{value:P(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var h="suspendedStart",d="suspendedYield",p="executing",y="completed",v={};function m(){}function g(){}function w(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,S=x&&x(x(A([])));S&&S!==r&&n.call(S,a)&&(b=S);var _=w.prototype=m.prototype=Object.create(b);function E(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,i,a,s){var c=f(e[o],e,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==me(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function P(t,r,n){var o=h;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=j(s,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var l=f(t,r,n);if("normal"===l.type){if(o=n.done?y:d,l.arg===v)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=y,n.method="throw",n.arg=l.arg)}}}function j(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,j(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function D(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(D,this),this.reset(!0)}function A(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(me(t)+" is not iterable")}return g.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:g,configurable:!0}),g.displayName=l(w,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,l(e,c,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},E(O.prototype),l(O.prototype,s,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new O(u(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},E(_),l(_,c,"Generator"),l(_,a,(function(){return this})),l(_,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=A,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:A(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}var _e=Se().mark(Oe),Ee=function(e,t){return 0===t?e:Ee(t,e%t)};function Oe(e,t){var r,n,o;return Se().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:r=0,n=Ee(e,t),o=0;case 3:if(!(o<e)){i.next=12;break}return o%(e/n)==0&&0!==o&&r++,i.next=7,r;case 7:r+=t,r%=e;case 9:o++,i.next=3;break;case 12:case"end":return i.stop()}}),_e)}function Pe(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=Ee(e,t),n=e%2==0?1*Math.PI/e:0,o=2*Math.sin(Math.PI*t/e),i=[],a=0,s=[1,-1];a<s.length;a++){var c,l=s[a],u=we(Oe(e,t));try{for(u.s();!(c=u.n()).done;){var f=c.value,h=2*Math.PI*f/e+n,d=Math.cos(h),p=Math.sin(h);i.push({x:d,y:l*o/2,z:-p})}}catch(e){u.e(e)}finally{u.f()}}for(var y=[],v=0;v<r;v++)for(var m=e/r*v;m<e/r*(v+1);m++){var g=m,w=(m+1)%(e/r*(v+1)),b=w+e,x=g+e;y.push([g,w+(0===w?e/r*v:0),b+(b===e?e/r*v:0),x])}y.push.apply(y,ge((0,_.chunk)(H(0,2*e-1),e/r)));var S=z(y).map((function(e){return e.map((function(e){return i[e]}))}));return{vertices:i,faces:y,edges:S}}function je(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=Ee(e,t),n=e%2==0?1*Math.PI/e:0,o=2*Math.sin(Math.PI*t/e),i=Math.sqrt(o**2-2*(1-Math.cos(Math.PI*t/e))),a=[],s=0,c=[1,-1];s<c.length;s++){var l,u=c[s],f=we(Oe(e,t));try{for(f.s();!(l=f.n()).done;){var h=l.value,d=2*Math.PI*h/e+n+(-1===u?Math.PI*t/e:0),p=Math.cos(d),y=Math.sin(d);a.push({x:p,y:u*i/2,z:-y})}}catch(e){f.e(e)}finally{f.f()}}var v=[];v.push.apply(v,ge((0,_.chunk)(H(0,2*e-1),e/r)));for(var m=0;m<r;m++)for(var g=e/r*m;g<e/r*(m+1);g++){var w=g,b=(g+1)%(e/r*(m+1)),x=w+e;b+=0===b?e/r*m:0,v.push([w,b,x]),v.push([x,b+e,b])}var S=z(v).map((function(e){return e.map((function(e){return a[e]}))}));return{vertices:a,faces:v,edges:S}}const De={prism:Pe,antiprism:je,trapezohedron:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=Ee(e,t),n=je(e,t),o=n.vertices,i=n.faces.map((function(e){return ee(e.map((function(e){return o[e]})))}));if(e/r>3){var a=[[(i=i.slice(2*r))[0],i[1],i[2]],[i[2],i[3],i[4]],[i[4],i[5],i[6]]],s=[[i[1],i[2],i[3]],[i[3],i[4],i[5]],[i[5],i[6],i[7]]];i.unshift(te(a),te(s))}for(var c=[],l=e/r,u=0;u<r;u++)for(var f=l*u;f<l*(u+1);f++){var h=2*f,d=h+1,p=(h+2)%(2*l*(u+1)),y=(h+3)%(2*l*(u+1));c.push([0,h+2,d+2,p+2]),c.push([1,d+2,p+2,y+2])}var v=z(c).map((function(e){return e.map((function(e){return i[e]}))}));return{vertices:i,faces:c,edges:v}},stephanoid:function(e,t,r){if(t===r||t+r>=e)throw alert("这个参数会生成退化的冠体。"),new Error("这个参数会生成退化的冠体。");var n=(ve()(t-r)?je(e):Pe(e)).vertices;if(t>r){var o=[r,t];t=o[0],r=o[1],n.forEach((function(e){return e.y=-e.y}))}var i=[];if(ve()(t-r))for(var a=0;a<e;a++)i.push([a,e+a,(r+a)%e,(t+a)%e+e]),i.push([a,((a-1)%e+e)%e+e,(t+a)%e,(r+a-1)%e+e]);else for(var s=0;s<e;s++)i.push([s,(s+1)%e+e,(r+s)%e,(t+s+1)%e+e]),i.push([s,((s-1)%e+e)%e+e,(t+s)%e,(r+s-1)%e+e]);var c=z(i).map((function(e){return e.map((function(e){return n[e]}))}));return{vertices:n,faces:i,edges:c}},duoprism:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=2*Math.sin(Math.PI*r/e)/(2*Math.sin(Math.PI*n/t)),i=e%2==0?1*Math.PI/e:0,a=Math.PI/2-Math.PI/t,s=Ee(e,r),c=Ee(t,n),l=[],u=[],f=[];if(1!==s||1!==c)throw alert("不支持复合双角柱。"),new Error("不支持复合双角柱。");var h,d=we(Oe(e,r));try{for(d.s();!(h=d.n()).done;){var p,y=h.value,v=2*Math.PI*y/e+i,m=Math.cos(v),g=Math.sin(v),w=we(Oe(t,n));try{for(w.s();!(p=w.n()).done;){var b=p.value,x=2*Math.PI*b/t+a,S=Math.cos(x)*o,_=Math.sin(x)*o;l.push({x:m,y:S,z:-g,w:_})}}catch(e){w.e(e)}finally{w.f()}}}catch(e){d.e(e)}finally{d.f()}for(var E=[],O=0;O<e;O++)for(var P=0;P<t;P++){var j=(O+1)%e,D=(P+1)%t,C=O*t+P,M=O*t+D,A=j*t+D,R=j*t+P;E.push([C,M,A,R])}for(var I=[],k=0;k<t;k++){for(var F=[],L=0;L<e;L++)F.push(L*t+k);I.push(F)}for(var G=[],B=0;B<e;B++){for(var T=[],J=0;J<t;J++)T.push(B*t+J);G.push(T)}u.push.apply(u,E),u.push.apply(u,I),u.push.apply(u,G);for(var N=0;N<t;N++){for(var H=[],U=0;U<e;U++){var V=U*t+N;H.push(V)}H.push(E.length+N),H.push(E.length+(N+1)%t),f.push(H)}for(var q=0;q<e;q++){for(var W=[],Y=0;Y<t;Y++){var $=q*t+Y;W.push($)}W.push(E.length+t+q),W.push(E.length+t+(q+1)%e),f.push(W)}var Z=z(u).map((function(e){return e.map((function(e){return l[e]}))}));return{vertices:l,faces:u,edges:Z,cells:f}}};function Ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||Me(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Me(e,t){if(e){if("string"==typeof e)return Ae(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ae(e,t):void 0}}function Ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Re(e){var t=e.split("\n").filter((function(e){return""!==e.trim()&&!e.startsWith("#")}));if("OFF"!==t[0].trim())throw new Error("Invalid OFF file format");for(var r=Ce(t[1].trim().split(/\s+/).map(Number),2),n=r[0],o=r[1],i=[],a=0;a<n;a++){var s=Ce(t[a+2].trim().split(/\s+/).map(parseFloat),3),c=s[0],l=s[1],u=s[2];i.push({x:c,y:l,z:u})}for(var f=[],h=0;h<o;h++){var d=t[h+2+n].trim().split(/\s+/),p=parseInt(d[0]);f.push(d.slice(1,p+1).map(Number))}var y=z(f).map((function(e){return e.map((function(e){return i[e]}))}));return{vertices:i,faces:f,edges:y}}function Ie(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||ke(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ke(e,t){if(e){if("string"==typeof e)return Fe(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Fe(e,t):void 0}}function Fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Le(e){var t=e.split("\n").filter((function(e){return""!==e.trim()&&!e.startsWith("#")}));if("4OFF"!==t[0].trim())throw new Error("Invalid 4OFF file format");for(var r=Ie(t[1].trim().split(/\s+/).map(Number),4),n=r[0],o=r[1],i=r[3],a=[],s=0;s<n;s++){var c=Ie(t[s+2].trim().split(/\s+/).map(parseFloat),4),l=c[0],u=c[1],f=c[2],h=c[3];a.push({x:l,y:u,z:f,w:h})}for(var d=[],p=0;p<o;p++){var y=t[p+2+n].trim().split(/\s+/),v=parseInt(y[0]);d.push(y.slice(1,v+1).map(Number))}for(var m=[],g=0;g<i;g++){var w=t[g+2+n+o].trim().split(/\s+/),b=parseInt(w[0]);m.push(w.slice(1,b+1).map(Number))}var x=z(d).map((function(e){return e.map((function(e){return a[e]}))}));return{vertices:a,faces:d,edges:x,cells:m}}var Ge=r(5072),ze=r.n(Ge),Be=r(7825),Te=r.n(Be),Je=r(7659),Ne=r.n(Je),He=r(5056),Ue=r.n(He),Ve=r(540),qe=r.n(Ve),We=r(1113),Ye=r.n(We),$e=r(1208),Ze={};Ze.styleTagTransform=Ye(),Ze.setAttributes=Ue(),Ze.insert=Ne().bind(null,"head"),Ze.domAPI=Te(),Ze.insertStyleElement=qe();ze()($e.A,Ze);$e.A&&$e.A.locals&&$e.A.locals;function Xe(e){return Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xe(e)}function Ke(e,t,r){if(et())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var o=new(e.bind.apply(e,n));return r&&Qe(o,r.prototype),o}function Qe(e,t){return Qe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Qe(e,t)}function et(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(et=function(){return!!e})()}function tt(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=ot(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function rt(e){return function(e){if(Array.isArray(e))return it(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ot(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||ot(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ot(e,t){if(e){if("string"==typeof e)return it(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?it(e,t):void 0}}function it(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function at(){at=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof m?t:m,a=Object.create(i.prototype),s=new M(n||[]);return o(a,"_invoke",{value:P(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var h="suspendedStart",d="suspendedYield",p="executing",y="completed",v={};function m(){}function g(){}function w(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,S=x&&x(x(A([])));S&&S!==r&&n.call(S,a)&&(b=S);var _=w.prototype=m.prototype=Object.create(b);function E(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,i,a,s){var c=f(e[o],e,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==Xe(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function P(t,r,n){var o=h;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=j(s,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var l=f(t,r,n);if("normal"===l.type){if(o=n.done?y:d,l.arg===v)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=y,n.method="throw",n.arg=l.arg)}}}function j(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,j(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function D(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(D,this),this.reset(!0)}function A(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(Xe(t)+" is not iterable")}return g.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:g,configurable:!0}),g.displayName=l(w,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,l(e,c,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},E(O.prototype),l(O.prototype,s,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new O(u(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},E(_),l(_,c,"Generator"),l(_,a,(function(){return this})),l(_,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=A,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:A(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function st(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function ct(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){st(i,n,o,a,s,"next",e)}function s(e){st(i,n,o,a,s,"throw",e)}a(void 0)}))}}function lt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ut(n.key),n)}}function ut(e){var t=function(e,t){if("object"!=Xe(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Xe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Xe(t)?t:t+""}window.WebMWriter=h(),window.download=function(e,t,r){var n=new Blob([e],{type:r}),o=URL.createObjectURL(n),i=document.createElement("a");i.href=o,i.download=t,i.click()};var ft=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ctrlsNav=null,this.offsNav=null,this.controlsPage=null,this.seleOffPage=null,this.canvas=null,this.faceVisibleSwitcher=null,this.wireframeVisibleSwitcher=null,this.verticesVisibleSwitcher=null,this.axisVisibleSwitcher=null,this.perspSwitcher=null,this.schleSwitcher=null,this.scaleFactorSlider=null,this.faceOpacitySlider=null,this.wireframeAndVerticesDimSlider=null,this.projectionDistanceSlider=null,this.fileInput=null,this.uploadOffBtn=null,this.infoDis=null,this.progCon=null,this.progDis=null,this.nanobar=null,this.startRecordBtn=null,this.stopRecordBtn=null,this.configFileInput=null,this.highlightCellsBtn=null,this.rotationSliders=[],this.offSeleEle=null,this.polyhedraSeleEle=null,this.polychoraSeleEle=null,this.genPrismBtn=null,this.prismNInput=null,this.genAntiprismBtn=null,this.antiprismNInput=null,this.genTrapezohedronBtn=null,this.trapezohedronNInput=null,this.genStephanoidBtn=null,this.stephanoidNInput=null,this.stephanoidAInput=null,this.stephanoidBInput=null,this.genDuoprismBtn=null,this.duoprismMInput=null,this.duoprismNInput=null,this.axesGroup=null,this.solidGroup=null,this.facesGroup=null,this.wireframeGroup=null,this.verticesGroup=null,this.rotAngles=[0,0,0,0,0,0],this.rotUni={value:new o.kn4},this.ofsUni={value:new o.IUQ(0,0,0,0)},this.ofs3Uni={value:new o.Pq0},this.axesOffsetScaleUni={value:1},this.projDistUni={value:2},this.isOrthoUni={value:0},this.cylinderRadiusUni={value:.5},this.sphereRadiusUni={value:1},this.renderer=null,this.isRenderingFlag=!1,this.scene=null,this.camera=null,this.controls=null,this.capturer=null,this.recordConfig=null,this.recordStates=null,this.isRecordingFlag=!1,this.stopRecordFlag=!1,this.cells=[],this.faces=[],this.facesMap={},this.nHedraInCells={},this.highlightedPartGroup=new o.YJl,this.loadMeshPromise=null,this.is4D=!1,this.scaleFactor=1,this.initialMaterial=new o.tXL({color:5592405,specular:2236962,shininess:50,flatShading:!0}),this.editor=null,this.init()},t=[{key:"importOff",value:(b=ct(at().mark((function e(t){var n;return at().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r(7074)("./".concat(t));case 3:return n=e.sent,e.abrupt("return",n.default);case 7:return e.prev=7,e.t0=e.catch(0),console.error("OFF 加载失败：",e.t0),e.abrupt("return",{});case 11:case"end":return e.stop()}}),e,null,[[0,7]])}))),function(e){return b.apply(this,arguments)})},{key:"init",value:(w=ct(at().mark((function e(){return at().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._initializeDomElements(),this._initializeRenderer(),this._initializeScene(),this._initializeCameras(),this._initializeLights(),this._initializeControls(),this._initializeJsonEditor(),e.next=9,pe(this.scene,this.rotUni,this.ofsUni,this.ofs3Uni,this.axesOffsetScaleUni);case 9:return this.axesGroup=e.sent,e.t0=this,e.next=13,this.importOff("polyhedra/KeplerPoinsot/Small_stellated_dodecahedron.off");case 13:return e.t1=e.sent,e.t2=this.initialMaterial,e.next=17,e.t0.loadMeshFromUrl.call(e.t0,e.t1,e.t2);case 17:this.setupEventListeners(),this.startRenderLoop();case 19:case"end":return e.stop()}}),e,this)}))),function(){return w.apply(this,arguments)})},{key:"_initializeDomElements",value:function(){this.ctrlsNav=document.getElementById("ctrlsNav"),this.offsNav=document.getElementById("offsNav"),this.controlsPage=document.getElementById("controls"),this.seleOffPage=document.getElementById("seleOff"),this.canvas=document.getElementById("polytopeRenderer"),this.faceVisibleSwitcher=document.getElementById("faceVisibleSwitcher"),this.wireframeVisibleSwitcher=document.getElementById("wireframeVisibleSwitcher"),this.verticesVisibleSwitcher=document.getElementById("verticesVisibleSwitcher"),this.axisVisibleSwitcher=document.getElementById("axisVisibleSwitcher"),this.perspSwitcher=document.getElementById("perspSwitcher"),this.schleSwitcher=document.getElementById("schleSwitcher"),this.scaleFactorSlider=document.getElementById("scaleFactorSlider"),this.faceOpacitySlider=document.getElementById("faceOpacitySlider"),this.wireframeAndVerticesDimSlider=document.getElementById("wireframeAndVerticesDimSlider"),this.projectionDistanceSlider=document.getElementById("projectionDistanceSlider"),this.fileInput=document.getElementById("fileInput"),this.uploadOffBtn=document.getElementById("uploadOff"),this.infoDis=document.getElementById("info"),this.progCon=document.getElementById("progContainer"),this.progDis=document.getElementById("prog"),this.startRecordBtn=document.getElementById("startRecord"),this.stopRecordBtn=document.getElementById("stopRecord"),this.configFileInput=document.getElementById("configFileInput"),this.highlightCellsBtn=document.getElementById("highlightCells"),this.offSeleEle=document.getElementById("offSele"),this.polyhedraSeleEle=document.getElementById("polyhedra"),this.polychoraSeleEle=document.getElementById("polychora"),this.genPrismBtn=document.getElementById("genPrism"),this.prismNInput=document.getElementById("prismN"),this.genAntiprismBtn=document.getElementById("genAntiprism"),this.antiprismNInput=document.getElementById("antiprismN"),this.genTrapezohedronBtn=document.getElementById("genTrapezohedron"),this.trapezohedronNInput=document.getElementById("trapezohedronN"),this.genStephanoidBtn=document.getElementById("genStephanoid"),this.stephanoidNInput=document.getElementById("stephanoidN"),this.stephanoidAInput=document.getElementById("stephanoidA"),this.stephanoidBInput=document.getElementById("stephanoidB"),this.genDuoprismBtn=document.getElementById("genDuoprism"),this.duoprismMInput=document.getElementById("duoprismM"),this.duoprismNInput=document.getElementById("duoprismN"),this.rotationSliders=["XY","XZ","XW","YZ","YW","ZW"].map((function(e){return document.getElementById("rot".concat(e,"Slider"))}))}},{key:"_initializeRenderer",value:function(){var e=this,t=window.devicePixelRatio||1;this.renderer=new i.JeP({antialias:!0,powerPreference:"high-performance",canvas:this.canvas});var r=Math.min(Math.min(window.innerWidth,window.innerHeight),720);this.renderer.setSize(r*t,r*t,!1),this.canvas.style.width="".concat(r,"px"),this.canvas.style.height="".concat(r,"px"),this.progCon.style.left="".concat(r/2+8,"px"),this.progCon.style.top="".concat(r/2+8,"px"),this.nanobar&&(this.nanobar.style.width="".concat(.7*r,"px")),window.addEventListener("resize",(function(){var r=Math.min(Math.min(window.innerWidth,window.innerHeight),720);e.renderer.setSize(r*t,r*t,!1),e.canvas.style.width="".concat(r,"px"),e.canvas.style.height="".concat(r,"px"),e.progCon.style.left="".concat(r/2+8,"px"),e.progCon.style.top="".concat(r/2+8,"px"),e.nanobar&&(e.nanobar.style.width="".concat(.7*r,"px"))}))}},{key:"_initializeScene",value:function(){this.scene=new o.Z58,this.scene.background=new o.Q1f(1118481)}},{key:"_initializeCameras",value:function(){this.camera=new o.ubm(60,1,.01,500),this.camera.position.set(0,0,120)}},{key:"_initializeLights",value:function(){var e=new o.ZyN(16777215);e.position.set(.5,.6,.4).normalize(),e.intensity=7,e.castShadow=!0,e.shadow.mapSize.width=2048,e.shadow.mapSize.height=2048,this.scene.add(e);var t=new o.$p8(2236962);t.intensity=100,this.scene.add(t);var r=new o.ZyN(14540266,.9);r.intensity=8,r.position.set(-.5,-.6,-.4).normalize(),r.castShadow=!0,r.shadow.mapSize.width=2048,r.shadow.mapSize.height=2048,this.scene.add(r)}},{key:"_initializeControls",value:function(){this.controls=new a.N(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.8,this.controls.enablePan=!1,this.controls.minDistance=1,this.controls.maxDistance=150,this.controls.minZoom=.7,this.controls.maxZoom=175}},{key:"_initializeJsonEditor",value:function(){this.editor=new d.Lz({doc:'{"0x555555FF": "all"}',extensions:[p.oQ,(0,y.Pq)(),v.bM,(0,m.bu)((0,y.cp)())],parent:document.querySelector("#jsonEditor")})}},{key:"render",value:function(){this.controls.update(),this.renderer.render(this.scene,this.camera)}},{key:"renderLoop",value:function(){this.isRenderingFlag&&(this.render(),requestAnimationFrame(this.renderLoop.bind(this)))}},{key:"startRenderLoop",value:function(){this.isRenderingFlag||(this.isRenderingFlag=!0,this.renderLoop())}},{key:"stopRenderLoop",value:function(){this.isRenderingFlag&&(this.isRenderingFlag=!1)}},{key:"createWireframeAndVertices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.cylinderMaterial,n=t.sphereMaterial,i=t.cylinderColor,a=void 0===i?7829367:i,s=t.sphereColor,c=void 0===s?16766720:s,l=r||new o._4j({color:a,metalness:.9,roughness:.3}),u=n||new o._4j({color:c,metalness:1,roughness:.3});l=S.cylinderMaterial3D(l,this.cylinderRadiusUni,this.rotUni,this.ofs3Uni),u=S.sphereMaterial3D(u,this.sphereRadiusUni,this.rotUni,this.ofs3Uni);var f=Y(new o.Ho_(1,1,1,16)),h=new o.ZLX(f,l,e.length),d=new Float32Array(3*e.length),p=new Float32Array(3*e.length),y=Y(new o.Gu$(1,16,16)),v=new o.ZLX(y,u,2*e.length);v.count=0;var m=[],g=new Set;e.forEach((function(e,t){var r=nt(e,2),n=r[0],i=r[1],a="".concat(n.x,",").concat(n.y,",").concat(n.z),s="".concat(i.x,",").concat(i.y,",").concat(i.z),c=new o.Pq0(n.x,n.y,n.z),l=new o.Pq0(i.x,i.y,i.z);d.set(c.toArray(),3*t),p.set(l.toArray(),3*t),g.has(a)||(m.push.apply(m,rt(c.toArray())),v.count++,g.add(a)),g.has(s)||(m.push.apply(m,rt(l.toArray())),v.count++,g.add(s))})),h.instanceMatrix.needsUpdate=!0,v.instanceMatrix.needsUpdate=!0,f.setAttribute("v1",new o.uWO(d,3)),f.setAttribute("v2",new o.uWO(p,3)),y.setAttribute("pos",new o.uWO(new Float32Array(m),3));var w=new o.YJl,b=new o.YJl;return w.add(h),b.add(v),{wireframeGroup:w,verticesGroup:b}}},{key:"create4DWireframeAndVertices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.cylinderMaterial,n=t.sphereMaterial,i=t.cylinderColor,a=void 0===i?7829367:i,s=t.sphereColor,c=void 0===s?16766720:s,l=r||new o._4j({color:a,metalness:.9,roughness:.3}),u=n||new o._4j({color:c,metalness:1,roughness:.3});l=S.cylinderMaterial(l,this.cylinderRadiusUni,this.rotUni,this.ofsUni,this.ofs3Uni,this.projDistUni,this.isOrthoUni),u=S.sphereMaterial(u,this.sphereRadiusUni,this.rotUni,this.ofsUni,this.ofs3Uni,this.projDistUni,this.isOrthoUni);var f=new o.YJl,h=new o.YJl,d=new Set,p=new Float32Array(4*e.length),y=new Float32Array(4*e.length),v=[];e.forEach((function(e,t){var r=nt(e,2),n=r[0],o=r[1],i="".concat(n.x,",").concat(n.y,",").concat(n.z,",").concat(n.w),a="".concat(o.x,",").concat(o.y,",").concat(o.z,",").concat(o.w);p.set(Object.values(n),4*t),y.set(Object.values(o),4*t),d.has(i)||(v.push(Object.values(n)),d.add(i)),d.has(a)||(v.push(Object.values(o)),d.add(a))}));var m=Y(new o.Ho_(1,1,1,16));m.setAttribute("v1",new o.uWO(p,4)),m.setAttribute("v2",new o.uWO(y,4));var g=new o.ZLX(m,l,e.length);f.add(g);var w=Y(new o.Gu$(1,16,16));w.setAttribute("center4D",new o.uWO(new Float32Array(v.flat()),4));var b=new o.ZLX(w,u,v.length);return h.add(b),{wireframeGroup:f,verticesGroup:h}}},{key:"loadMesh",value:function(e,t){this.is4D=!1,this.cells=[],this.faces=e.faces,this.facesMap=e.facesMap,this.nHedraInCells={},this.highlightedPartGroup.clear(),this.solidGroup&&(W(this.solidGroup),this.scene.remove(this.solidGroup)),this.updateEnable();var r=new o.B69,n=new o.LoY,i=new Float32Array(3*e.vertices.length);e.vertices.forEach((function(e,t){i[3*t]=e.x,i[3*t+1]=e.y,i[3*t+2]=e.z})),n.setAttribute("position",new o.THS(i,3));var a=[];e.faces.forEach((function(e){return a.push.apply(a,rt(e))})),n.setIndex(a),n.computeVertexNormals(),(t=S.faceMaterial3D(t,this.rotUni,this.ofs3Uni)).side=o.$EB;var s=new o.eaF(n,t);this.updateScaleFactor(40/U(e.vertices));var c=this.createWireframeAndVertices(e.edges),l=c.wireframeGroup,u=c.verticesGroup;return r.add(s),r.add(l),r.add(u),r.scale.setScalar(this.scaleFactor),r.add(this.highlightedPartGroup),this.scene.add(r),{scaleFactor:this.scaleFactor,solidGroup:r,facesGroup:s,wireframeGroup:l,verticesGroup:u}}},{key:"load4DMesh",value:function(e,t){var r=this;this.is4D=!0,this.cells=e.cells,this.faces=e.faces,this.facesMap=e.facesMap,this.nHedraInCells={},e.cells.forEach((function(e,t){Object.hasOwnProperty.call(r.nHedraInCells,e.facesCount)?r.nHedraInCells[e.facesCount].push(t):r.nHedraInCells[e.facesCount]=[t]})),this.solidGroup&&(W(this.solidGroup),this.scene.remove(this.solidGroup)),this.highlightedPartGroup.clear(),this.updateEnable();var n=new o.YJl,i=new o.LoY,a=new Float32Array(3*e.vertices.length);e.vertices.forEach((function(e,t){a[3*t]=e.x,a[3*t+1]=e.y,a[3*t+2]=e.z})),i.setAttribute("position",new o.THS(a,3));var s=new Float32Array(4*e.vertices.length);e.vertices.forEach((function(e,t){s[4*t]=e.x,s[4*t+1]=e.y,s[4*t+2]=e.z,s[4*t+3]=e.w})),i.setAttribute("position4D",new o.THS(s,4));var c=[];e.faces.forEach((function(e){return c.push.apply(c,rt(e))})),i.setIndex(c),i.computeVertexNormals(),(t=S.faceMaterial(t,this.rotUni,this.ofsUni,this.ofs3Uni,this.projDistUni,this.isOrthoUni)).side=o.$EB;var l=new o.eaF(i,t);this.projectionDistanceSlider.value=1.05*V(e.vertices),this.updateProjectionDistance(),this.updateScaleFactor(40/U(e.vertices.map((function(e){if(!r.schleSwitcher.checked)return{x:e.x,y:e.y,z:e.z};var t=+r.projectionDistanceSlider.value,n=t/(t+e.w);return{x:e.x*n,y:e.y*n,z:e.z*n}}))));var u=this.create4DWireframeAndVertices(e.edges),f=u.wireframeGroup,h=u.verticesGroup;return n.add(l),n.add(f),n.add(h),n.scale.setScalar(this.scaleFactor),n.add(this.highlightedPartGroup),this.scene.add(n),{scaleFactor:this.scaleFactor,solidGroup:n,facesGroup:l,wireframeGroup:f,verticesGroup:h}}},{key:"processMeshData",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=new(c())({target:this.progCon}),i=new AbortController,a=new Worker(new URL(r.p+r.u(3233),r.b));return this.nanobar=o.el,o.el.style.position="static",{promise:new Promise((function(r,i){a.postMessage({meshData:e,is4D:n}),a.addEventListener("message",(function(e){var n=e.data,s=n.type,c=n.data;switch(s){case"progress":t.progDis.innerHTML="".concat(c.progress.toFixed(2),"%<br />（").concat(c.current,"/").concat(c.total,"）"),o.go(c.progress);break;case"complete":a.terminate(),t.progDis.innerText="",o.el.remove(),t.loadMeshPromise=null,t.nanobar=null,r(c);break;case"error":a.terminate(),t.progDis.innerText="",o.el.remove(),t.loadMeshPromise=null,t.nanobar=null,i(c)}}))})),abort:function(){i.abort(),a.terminate(),t.progDis.innerText="",o.el.remove(),t.loadMeshPromise=null,t.nanobar=null}}}},{key:"loadMeshFromData",value:(g=ct(at().mark((function e(t,r){var n,o,i,a,s,c,l,u,f;return at().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadMeshPromise&&this.loadMeshPromise.abort(),n=t instanceof Object?t:Re(t),this.loadMeshPromise=this.processMeshData(n),e.next=5,this.loadMeshPromise.promise;case 5:o=e.sent,i="\n    顶点数：".concat(n.vertices.length,"\n    边数：").concat(n.edges.length,"\n    面数：").concat(n.faces.length,"\n    ").trim().replace(" ",""),this.infoDis.innerText=i,a=this.loadMesh(o,r),s=a.scaleFactor,c=a.solidGroup,l=a.facesGroup,u=a.wireframeGroup,f=a.verticesGroup,this.scaleFactor=s,this.solidGroup=c,this.facesGroup=l,this.wireframeGroup=u,this.verticesGroup=f,this.updateProperties();case 15:case"end":return e.stop()}}),e,this)}))),function(e,t){return g.apply(this,arguments)})},{key:"loadMeshFrom4Data",value:(h=ct(at().mark((function e(t,r){var n,o,i,a,s,c,l,u,f;return at().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadMeshPromise&&this.loadMeshPromise.abort(),n=t instanceof Object?t:Le(t),this.loadMeshPromise=this.processMeshData(n,!0),e.next=5,this.loadMeshPromise.promise;case 5:o=e.sent,i="\n    顶点数：".concat(n.vertices.length,"\n    边数：").concat(n.edges.length,"\n    面数：").concat(n.faces.length,"\n    胞数：").concat(n.cells.length,"\n    ").trim().replace(" ",""),this.infoDis.innerText=i,a=this.load4DMesh(o,r),s=a.scaleFactor,c=a.solidGroup,l=a.facesGroup,u=a.wireframeGroup,f=a.verticesGroup,this.scaleFactor=s,this.solidGroup=c,this.facesGroup=l,this.wireframeGroup=u,this.verticesGroup=f,this.updateProperties(),this.updateProjectionDistance(),this.updateRotation();case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"loadMeshFromUrl",value:(f=ct(at().mark((function e(t,r){var n,o=this,i=arguments;return at().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>2&&void 0!==i[2]&&i[2],e.abrupt("return",new Promise((function(e){fetch(t).then((function(e){if(!e.ok)throw new Error("网络响应不正常。");return e.text()})).then(function(){var t=ct(at().mark((function t(i){return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(n?o.loadMeshFrom4Data.bind(o):o.loadMeshFromData.bind(o))(i,r);case 2:e();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())})));case 2:case"end":return e.stop()}}),e)}))),function(e,t){return f.apply(this,arguments)})},{key:"highlightCells",value:function(e){var t=this;this.highlightedPartGroup.clear();for(var r=function(){var e=nt(i[n],2),r=e[0],a=e[1];if(!/^(0x)?[0-9a-fA-F]{8}$/.test(r))throw new Error("十六进制 RGBA 色码 ".concat(r," 无效。"));K(a,r+".");var s=t.facesGroup.geometry.clone(),c=S.faceMaterial(t.facesGroup.material,t.rotUni,t.ofsUni,t.ofs3Uni,t.projDistUni,t.isOrthoUni),l=parseInt(r,16),u=l>>8,f=255&l;if(c.color.set(u),c.transparent=255!==f,c.opacity=f/255,c.visible=!0,"all"===a){var h=[];return t.faces.forEach((function(e){return h.push.apply(h,rt(e))})),s.setIndex(h),s.computeVertexNormals(),t.highlightedPartGroup.add(new o.eaF(s,c)),1}var d=[];if(Object.hasOwnProperty.call(a,"indices")){var p,y=tt(a.indices);try{for(y.s();!(p=y.n()).done;){var v=p.value;if(!t.cells[v])throw new Error("索引为 ".concat(v," 的胞不存在。"))}}catch(e){y.e(e)}finally{y.f()}d.push.apply(d,rt(a.indices))}if(Object.hasOwnProperty.call(a,"ranges")){var m,g=tt(a.ranges.entries());try{for(g.s();!(m=g.n()).done;){var w=nt(m.value,2),b=w[0],x=nt(w[1],2),_=x[0],E=x[1];if(!t.cells[_])throw new Error("ranges[".concat(b,"] 的起始索引 ").concat(_," 对应的胞不存在。"));if(!t.cells[E-1])throw new Error("ranges[".concat(b,"] 的结束索引 ").concat(E," 对应的胞不存在。"));d.push.apply(d,rt(H(_,E-1)))}}catch(e){g.e(e)}finally{g.f()}}if(Object.hasOwnProperty.call(a,"nHedra")){var O,P=tt(a.nHedra.entries());try{for(P.s();!(O=P.n()).done;){var j=nt(O.value,2),D=j[0],C=j[1];if("number"==typeof C){var M=C;if(!t.nHedraInCells[M])throw new Error("nHedra[".concat(D,"] 指定的 ").concat(M," 面体胞不存在。"));d.push.apply(d,rt(t.nHedraInCells[M]))}else if(C instanceof Object){var A=C.nFaces,R=C.ranges;if(!t.nHedraInCells[A])throw new Error("nHedra[".concat(D,"] 指定的 ").concat(A," 面体胞不存在。"));var I,k=[],F=tt(R.entries());try{for(F.s();!(I=F.n()).done;){var L,G=nt(I.value,2),z=G[0],B=G[1],T=nt(B,2),J=T[0],N=T[1];if(J>=t.nHedraInCells[A].length)throw new Error("nHedra[".concat(D,"].ranges[").concat(z,"] 的起始索引 ").concat(J," 超出范围。"));if(N>t.nHedraInCells[A].length)throw new Error("nHedra[".concat(D,"].ranges[").concat(z,"] 的结束索引 ").concat(N," 超出范围。"));k.push.apply(k,rt((L=t.nHedraInCells[A]).slice.apply(L,rt(B))))}}catch(e){F.e(e)}finally{F.f()}d.push.apply(d,k)}}}catch(e){P.e(e)}finally{P.f()}}if(Object.hasOwnProperty.call(a,"exclude")){var U=a.exclude;if(Object.hasOwnProperty.call(U,"indices")){var V,q=tt(U.indices);try{for(q.s();!(V=q.n()).done;){var W=V.value;if(!t.cells[W])throw new Error("exclude.indices 中的索引 ".concat(W," 对应的胞不存在。"))}}catch(e){q.e(e)}finally{q.f()}ne(d,U.indices)}if(Object.hasOwnProperty.call(U,"ranges")){var Y,$=tt(U.ranges.entries());try{for($.s();!(Y=$.n()).done;){var Z=nt(Y.value,2),X=Z[0],Q=nt(Z[1],2),ee=Q[0],te=Q[1];if(!t.cells[ee])throw new Error("exclude.ranges[".concat(X,"] 的起始索引 ").concat(ee," 对应的胞不存在。"));if(!t.cells[te-1])throw new Error("exclude.ranges[".concat(X,"] 的结束索引 ").concat(te," 对应的胞不存在。"));ne(d,H(ee,te-1))}}catch(e){$.e(e)}finally{$.f()}}if(Object.hasOwnProperty.call(U,"nHedra")){var re,oe=tt(U.nHedra.entries());try{for(oe.s();!(re=oe.n()).done;){var ie=nt(re.value,2),ae=ie[0],se=ie[1];if("number"==typeof se){var ce=se;if(!t.nHedraInCells[ce])throw new Error("exclude.nHedra[".concat(ae,"] 指定的 ").concat(ce," 面体胞不存在。"));ne(d,t.nHedraInCells[ce])}else if(se instanceof Object){var le=se.nFaces,ue=se.ranges;if(!t.nHedraInCells[le])throw new Error("exclude.nHedra[".concat(ae,"] 指定的 ").concat(le," 面体胞不存在。"));var fe,he=[],de=tt(ue.entries());try{for(de.s();!(fe=de.n()).done;){var pe,ye=nt(fe.value,2),ve=ye[0],me=ye[1],ge=nt(me,2),we=ge[0],be=ge[1];if(we>=t.nHedraInCells[le].length)throw new Error("exclude.nHedra[".concat(ae,"].ranges[").concat(ve,"] 的起始索引 ").concat(we," 超出范围。"));if(be>t.nHedraInCells[le].length)throw new Error("exclude.nHedra[".concat(ae,"].ranges[").concat(ve,"] 的结束索引 ").concat(be," 超出范围。"));he.push.apply(he,rt((pe=t.nHedraInCells[le]).slice.apply(pe,rt(me))))}}catch(e){de.e(e)}finally{de.f()}ne(d,he)}}}catch(e){oe.e(e)}finally{oe.f()}}}for(var xe=[],Se=0,_e=d;Se<_e.length;Se++){var Ee,Oe=_e[Se],Pe=tt(t.cells[Oe].faceIndices);try{for(Pe.s();!(Ee=Pe.n()).done;){var je=Ee.value;xe.push.apply(xe,rt(t.faces[je]))}}catch(e){Pe.e(e)}finally{Pe.f()}}s.setIndex(xe),s.computeVertexNormals(),t.highlightedPartGroup.add(new o.eaF(s,c))},n=0,i=Object.entries(e);n<i.length;n++)r()}},{key:"updateProperties",value:function(){q(this.facesGroup,"visible",this.faceVisibleSwitcher.checked),q(this.wireframeGroup,"visible",this.wireframeVisibleSwitcher.checked),q(this.verticesGroup,"visible",this.verticesVisibleSwitcher.checked),q(this.axesGroup,"visible",this.axisVisibleSwitcher.checked),q(this.facesGroup,"opacity",+this.faceOpacitySlider.value),q(this.facesGroup,"transparent",1!=+this.faceOpacitySlider.value),this.toggleCamera(this.perspSwitcher.checked),this.cylinderRadiusUni.value=+this.wireframeAndVerticesDimSlider.value/this.scaleFactor,this.sphereRadiusUni.value=+this.wireframeAndVerticesDimSlider.value/this.scaleFactor*2,this.ofsUni.value=new o.IUQ(0,0,0,0),this.ofs3Uni.value=new o.Pq0}},{key:"updateProjectionDistance",value:function(){this.projDistUni.value=+this.projectionDistanceSlider.value}},{key:"updateRotation",value:function(){var e=this.rotationSliders.map((function(e){return+e.value}));this.rotAngles=e,this.rotUni.value=$.apply(n,rt(this.rotAngles))}},{key:"updateScaleFactor",value:function(e){this.scaleFactor=e,this.scaleFactorSlider.value=e,this.cylinderRadiusUni.value=+this.wireframeAndVerticesDimSlider.value/e,this.sphereRadiusUni.value=+this.wireframeAndVerticesDimSlider.value/e*2,this.solidGroup&&this.solidGroup.scale.setScalar(e),this.axesOffsetScaleUni.value=e}},{key:"updateEnable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];!function(e){document.querySelectorAll("input, button").forEach((function(t){t.disabled=!e}))}(e),this.stopRecordBtn.disabled=!this.isRecordingFlag,e&&(this.projectionDistanceSlider.disabled=!0,this.schleSwitcher.disabled||this.is4D||(this.rotationSliders[2].value=0,this.rotationSliders[4].value=0,this.rotationSliders[5].value=0,this.updateRotation()),this.projectionDistanceSlider.disabled=!this.is4D,this.schleSwitcher.disabled=!this.is4D,this.highlightCellsBtn.disabled=!this.is4D,this.rotationSliders[2].disabled=!this.is4D,this.rotationSliders[4].disabled=!this.is4D,this.rotationSliders[5].disabled=!this.is4D,this.startRecordBtn.disabled=this.isRecordingFlag)}},{key:"toggleCamera",value:function(e){var t=this.camera.clone();this.camera=e?new o.ubm(60,1,.01,500):new o.qUd(-60,60,60,-60,.01,500),this.camera.position.copy(t.position),this.camera.rotation.copy(t.rotation),this._initializeControls()}},{key:"setupEventListeners",value:function(){var e=this;this.faceVisibleSwitcher.addEventListener("change",(function(){return q(e.facesGroup,"visible",e.faceVisibleSwitcher.checked)})),this.wireframeVisibleSwitcher.addEventListener("change",(function(){return q(e.wireframeGroup,"visible",e.wireframeVisibleSwitcher.checked)})),this.verticesVisibleSwitcher.addEventListener("change",(function(){return q(e.verticesGroup,"visible",e.verticesVisibleSwitcher.checked)})),this.axisVisibleSwitcher.addEventListener("change",(function(){return q(e.axesGroup,"visible",e.axisVisibleSwitcher.checked)})),this.scaleFactorSlider.addEventListener("input",(function(){return e.updateScaleFactor(+e.scaleFactorSlider.value)})),this.faceOpacitySlider.addEventListener("input",(function(){q(e.facesGroup,"opacity",+e.faceOpacitySlider.value),q(e.facesGroup,"transparent",1!=+e.faceOpacitySlider.value)})),this.wireframeAndVerticesDimSlider.addEventListener("input",(function(){e.cylinderRadiusUni.value=+e.wireframeAndVerticesDimSlider.value/e.scaleFactor,e.sphereRadiusUni.value=+e.wireframeAndVerticesDimSlider.value/e.scaleFactor*2})),this.projectionDistanceSlider.addEventListener("input",this.updateProjectionDistance.bind(this)),this.rotationSliders.forEach((function(t,r){t.addEventListener("input",(function(){e.rotAngles[r]=+t.value,e.rotUni.value=$.apply(n,rt(e.rotAngles))}))})),this.perspSwitcher.addEventListener("change",(function(){return e.toggleCamera(e.perspSwitcher.checked)})),this.schleSwitcher.addEventListener("change",(function(){return e.isOrthoUni.value=!e.schleSwitcher.checked})),this.uploadOffBtn.addEventListener("click",(function(){return e.fileInput.click()})),this.fileInput.addEventListener("change",this.handleFileInputChange.bind(this)),this.highlightCellsBtn.addEventListener("click",(function(){var t=JSON.parse(e.editor.state.doc.toString());e.faceVisibleSwitcher.checked=!1,e.updateProperties();try{e.highlightCells(t)}catch(e){alert(e.message),console.error(e)}})),this.startRecordBtn.addEventListener("click",this.startRecord.bind(this)),this.stopRecordBtn.addEventListener("click",(function(){return e.stopRecordFlag=!0})),this.polyhedraSeleEle.querySelectorAll("a").forEach((function(t){t.addEventListener("click",ct(at().mark((function r(){return at().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=e,r.next=3,e.importOff("polyhedra/".concat(t.dataset.path));case 3:return r.t1=r.sent,r.t2=e.initialMaterial,r.next=7,r.t0.loadMeshFromUrl.call(r.t0,r.t1,r.t2);case 7:case"end":return r.stop()}}),r)}))))})),this.polychoraSeleEle.querySelectorAll("a").forEach((function(t){t.addEventListener("click",ct(at().mark((function r(){return at().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=e,r.next=3,e.importOff("polychora/".concat(t.dataset.path));case 3:return r.t1=r.sent,r.t2=e.initialMaterial,r.next=7,r.t0.loadMeshFromUrl.call(r.t0,r.t1,r.t2,!0);case 7:case"end":return r.stop()}}),r)}))))})),this.setupNavEventListeners(),this.setupCollapseEventListeners(),this.setupSolidInfFamiliesEventListeners()}},{key:"setupNavEventListeners",value:function(){var e=this;this.ctrlsNav.addEventListener("click",(function(){e.controlsPage.style.display="flex",e.seleOffPage.style.display="none",e.ctrlsNav.classList.add("active"),e.offsNav.classList.remove("active")})),this.offsNav.addEventListener("click",(function(){e.controlsPage.style.display="none",e.seleOffPage.style.display="block",e.ctrlsNav.classList.remove("active"),e.offsNav.classList.add("active")}))}},{key:"setupCollapseEventListeners",value:function(){this.offSeleEle.querySelectorAll("li:has(span)").forEach((function(e){e.querySelector("span").addEventListener("click",(function(){var t=e.querySelector("ul");t.style.display="none"===t.style.display?null:"none"}))}))}},{key:"setupSolidInfFamiliesEventListeners",value:function(){var e=this;this.genPrismBtn.addEventListener("click",ct(at().mark((function t(){var r,n,o,i;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.prismNInput.value.split("/").map((function(e){return+e})),n=nt(r,2),o=n[0],i=n[1],t.next=3,e.loadMeshFromData(De.prism(o,i),e.initialMaterial);case 3:case"end":return t.stop()}}),t)})))),this.genAntiprismBtn.addEventListener("click",ct(at().mark((function t(){var r,n,o,i;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.antiprismNInput.value.split("/").map((function(e){return+e})),n=nt(r,2),o=n[0],i=n[1],t.next=3,e.loadMeshFromData(De.antiprism(o,i),e.initialMaterial);case 3:case"end":return t.stop()}}),t)})))),this.genTrapezohedronBtn.addEventListener("click",ct(at().mark((function t(){var r,n,o,i;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.trapezohedronNInput.value.split("/").map((function(e){return+e})),n=nt(r,2),o=n[0],i=n[1],t.next=3,e.loadMeshFromData(De.trapezohedron(o,i),e.initialMaterial);case 3:case"end":return t.stop()}}),t)})))),this.genStephanoidBtn.addEventListener("click",ct(at().mark((function t(){var r,n,o;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=+e.stephanoidNInput.value,n=+e.stephanoidAInput.value,o=+e.stephanoidBInput.value,t.next=5,e.loadMeshFromData(De.stephanoid(r,n,o),e.initialMaterial);case 5:case"end":return t.stop()}}),t)})))),this.genDuoprismBtn.addEventListener("click",ct(at().mark((function t(){var r,n,o,i,a,s,c,l;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.duoprismMInput.value.split("/").map((function(e){return+e})),n=nt(r,2),o=n[0],i=n[1],a=e.duoprismNInput.value.split("/").map((function(e){return+e})),s=nt(a,2),c=s[0],l=s[1],t.next=4,e.loadMeshFrom4Data(De.duoprism(o,c,i,l),e.initialMaterial);case 4:case"end":return t.stop()}}),t)}))))}},{key:"handleFileInputChange",value:function(e){var t=this,r=e.target.files[0];if(r){var n=new FileReader;n.onload=function(){var e=ct(at().mark((function e(r){var n;return at().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.target.result,t.is4D="4OFF"===n.split("\n").filter((function(e){return""!==e.trim()&&!e.startsWith("#")}))[0].trim(),!t.is4D){e.next=7;break}return e.next=5,t.loadMeshFrom4Data(n,t.initialMaterial);case 5:e.next=9;break;case 7:return e.next=9,t.loadMeshFromData(n,t.initialMaterial);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.readAsText(r)}}},{key:"startRecord",value:(l=ct(at().mark((function e(){var t,r,i,a,s,c,l,f,h,d,p=this;return at().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Q(this.configFileInput);case 3:this.recordConfig=e.sent,X(this.recordConfig,this.is4D),e.next=12;break;case 7:return e.prev=7,e.t0=e.catch(0),alert(e.t0.message),console.error(e.t0),e.abrupt("return");case 12:this.isRecordingFlag=!0,this.updateEnable(!1),this.recordStates={rots:{Infinity:this.recordConfig.initialRot?$.apply(n,rt(this.recordConfig.initialRot)):this.rotUni.value},ofs:this.recordConfig.initialOfs?Ke(o.IUQ,rt(this.recordConfig.initialOfs)):this.ofsUni.value,ofs3:this.recordConfig.initialOfs3?Ke(o.Pq0,rt(this.recordConfig.initialOfs3)):this.ofs3Uni.value,verticesEdgesDim:null!==(t=this.recordConfig.initialVerticesEdgesDim)&&void 0!==t?t:this.cylinderRadiusUni.value*this.scaleFactor,projDist:null!==(r=this.recordConfig.initialProjDist)&&void 0!==r?r:this.projDistUni.value,faceOpacity:null!==(i=this.recordConfig.initialFaceOpacity)&&void 0!==i?i:+this.faceOpacitySlider.value,visibilities:null!==(a=this.recordConfig.initialVisibilities)&&void 0!==a?a:{faces:this.faceVisibleSwitcher.checked,wireframe:this.wireframeVisibleSwitcher.checked,vertices:this.verticesVisibleSwitcher.checked,axes:this.axisVisibleSwitcher.checked},cameraIsPersp:this.recordConfig.initialCameraProjMethod?"persp"===this.recordConfig.initialCameraProjMethod:this.perspSwitcher.checked,schleProjEnable:null!==(s=this.recordConfig.initialSchleProjEnable)&&void 0!==s?s:!this.isOrthoUni.value,highlightConfig:null!==(c=this.recordConfig.initialHighlightConfig)&&void 0!==c?c:JSON.parse(this.editor.state.doc.toString())},l=Math.max.apply(Math,rt(this.recordConfig.actions.map((function(e,t){var r,n;return e.index=t,null!==(r=null!==(n=e.end)&&void 0!==n?n:e.at)&&void 0!==r?r:-1})))),this.rotAngles=[0,0,0,0,0,0],this.rotUni.value=new o.kn4,this.stopRenderLoop(),this.controls.dispose(),this.capturer=new(u())({format:"webm",framerate:30,name:"Animation",verbose:!0}),this.capturer.start(),f=0,h=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];p.capturer.stop(),e||p.capturer.save(),p.capturer=null,p.isRecordingFlag=!1,p.updateProperties(),p.updateProjectionDistance(),p.updateRotation(),p.highlightCells(JSON.parse(p.editor.state.doc.toString())),p._initializeControls(),p.startRenderLoop(),p.updateEnable()},(d=function(){if(f>=l||p.stopRecordFlag)return h(),void(p.stopRecordFlag=!1);try{p.genFrame(f),p.capturer.capture(p.canvas)}catch(e){return alert(e.message),h(!0),void console.error(e)}f++,requestAnimationFrame(d)})();case 26:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return l.apply(this,arguments)})},{key:"genFrame",value:function(e){var t,r,n,i;this.updateRecordStates(e);var a=this.recordStates,s=a.rots,c=a.ofs,l=a.ofs3,u=a.verticesEdgesDim,f=a.projDist,h=a.faceOpacity,d=a.visibilities,p=a.cameraIsPersp,y=a.schleProjEnable,v=Z(s).reduce((function(e,t){var r=new o.kn4;return r.multiplyMatrices(e,t),r}),(new o.kn4).identity());this.camera.position.set(0,0,120),this.camera.rotation.set(0,0,0),this.rotUni.value=v,this.ofsUni.value=c,this.ofs3Uni.value=l,this.sphereRadiusUni.value=2*u/this.scaleFactor,this.cylinderRadiusUni.value=u/this.scaleFactor,this.projDistUni.value=f,this.isOrthoUni.value=!y,q(this.facesGroup,"opacity",h),q(this.facesGroup,"transparent",1!==h),q(this.facesGroup,"visible",null===(t=d.faces)||void 0===t||t),q(this.wireframeGroup,"visible",null===(r=d.wireframe)||void 0===r||r),q(this.verticesGroup,"visible",null===(n=d.vertices)||void 0===n||n),q(this.axesGroup,"visible",null===(i=d.axes)||void 0===i||i),this.toggleCamera(p),this.highlightCells(this.recordStates.highlightConfig),this.render()}},{key:"updateRecordStates",value:function(e){var t,r,i=tt(this.recordConfig.actions.filter((function(t){return t.start<=e&&e<t.end||e===t.at})));try{for(i.s();!(r=i.n()).done;){var a=r.value;switch(a.type){case"rot":var s=[0,0,0,0,0,0];s[a.plane]=a.angle/(a.end-a.start),this.recordStates.rots[a.index]?this.recordStates.rots[a.index].multiply($.apply(n,s)):this.recordStates.rots[a.index]=$.apply(n,s);break;case"trans4":this.recordStates.ofs.add(Ke(o.IUQ,rt(a.ofs)).divideScalar(a.end-a.start));break;case"trans3":this.recordStates.ofs3.add(Ke(o.Pq0,rt(a.ofs)).divideScalar(a.end-a.start));break;case"setVerticesEdgesDim":if(this.recordStates.verticesEdgesDim+=a.dimOfs/(a.end-a.start),this.recordStates.verticesEdgesDim<=0)throw new Error("actions[".concat(a.index,"] 错误地导致边和顶点的尺寸为负数。"));break;case"setProjDist":if(this.recordStates.projDist+=a.projDistOfs/(a.end-a.start),this.recordStates.projDist<=0)throw new Error("actions[".concat(a.index,"] 错误地导致投影距离为负数。"));break;case"setFaceOpacity":if(this.recordStates.faceOpacity+=a.faceOpacityOfs/(a.end-a.start),this.recordStates.faceOpacity<0||this.recordStates.faceOpacity>1)throw new Error("actions[".concat(a.index,"] 错误地导致面透明度超出 0~1 的范围。"));break;case"setVisibility":this.recordStates.visibilities[a.target]=a.visibility;break;case"setCameraProjMethod":this.recordStates.cameraIsPersp="persp"===a.projMethod;break;case"setSchleProjEnable":this.recordStates.schleProjEnable=a.enable;break;case"highlightCells":this.recordStates.visibilities.faces=!(null===(t=a.hideFaces)||void 0===t||t),this.recordStates.highlightConfig=a.highlightConfig}}}catch(e){i.e(e)}finally{i.f()}}}],t&&lt(e.prototype,t),s&&lt(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,s,l,f,h,g,w,b}();document.addEventListener("DOMContentLoaded",(function(){return new ft}))}},i={};function a(e){var t=i[e];if(void 0!==t)return t.exports;var r=i[e]={id:e,loaded:!1,exports:{}};return o[e].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}a.m=o,e=[],a.O=(t,r,n,o)=>{if(!r){var i=1/0;for(u=0;u<e.length;u++){for(var[r,n,o]=e[u],s=!0,c=0;c<r.length;c++)(!1&o||i>=o)&&Object.keys(a.O).every((e=>a.O[e](r[c])))?r.splice(c--,1):(s=!1,o<i&&(i=o));if(s){e.splice(u--,1);var l=n();void 0!==l&&(t=l)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[r,n,o]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},r=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,a.t=function(e,n){if(1&n&&(e=this(e)),8&n)return e;if("object"==typeof e&&e){if(4&n&&e.__esModule)return e;if(16&n&&"function"==typeof e.then)return e}var o=Object.create(null);a.r(o);var i={};t=t||[null,r({}),r([]),r(r)];for(var s=2&n&&e;"object"==typeof s&&!~t.indexOf(s);s=r(s))Object.getOwnPropertyNames(s).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,a.d(o,i),o},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((t,r)=>(a.f[r](e,t),t)),[])),a.u=e=>"js/"+e+".chunk.js",a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},a.l=(e,t,r,o)=>{if(n[e])n[e].push(t);else{var i,s;if(void 0!==r)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var u=c[l];if(u.getAttribute("src")==e){i=u;break}}i||(s=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,a.nc&&i.setAttribute("nonce",a.nc),i.src=e),n[e]=[t];var f=(t,r)=>{i.onerror=i.onload=null,clearTimeout(h);var o=n[e];if(delete n[e],i.parentNode&&i.parentNode.removeChild(i),o&&o.forEach((e=>e(r))),t)return t(r)},h=setTimeout(f.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=f.bind(null,i.onerror),i.onload=f.bind(null,i.onload),s&&document.head.appendChild(i)}},a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),a.j=3057,(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var n=r.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=r[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e+"../"})(),(()=>{a.b=document.baseURI||self.location.href;var e={3057:0};a.f.j=(t,r)=>{var n=a.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var o=new Promise(((r,o)=>n=e[t]=[r,o]));r.push(n[2]=o);var i=a.p+a.u(t),s=new Error;a.l(i,(r=>{if(a.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var o=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+i+")",s.name="ChunkLoadError",s.type=o,s.request=i,n[1](s)}}),"chunk-"+t,t)}},a.O.j=t=>0===e[t];var t=(t,r)=>{var n,o,[i,s,c]=r,l=0;if(i.some((t=>0!==e[t]))){for(n in s)a.o(s,n)&&(a.m[n]=s[n]);if(c)var u=c(a)}for(t&&t(r);l<i.length;l++)o=i[l],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(u)},r=self.webpackChunk=self.webpackChunk||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),a.nc=void 0;var s=a.O(void 0,[8096],(()=>a(8676)));s=a.O(s)})();